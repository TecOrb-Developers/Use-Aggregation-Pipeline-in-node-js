"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _continuous=_interopRequireWildcard(require("./continuous"));var _number=_interopRequireDefault(require("../scale-utils/interpolators/number"));var _ticks=_interopRequireWildcard(require("../time-intervals/ticks"));var _enUS=_interopRequireDefault(require("../time-converter/locales/en-US"));var _timeConverter=require("../time-converter");function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}var durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,date=function date(d){return new Date(d)},number=function number(n){return n instanceof Date?+n:+new Date(+n)},_nice=function nice(domain,interval){var d=domain.slice();var firstDomainIdx=0,lastDomainIdx=d.length-1,firstDomainElem=d[firstDomainIdx],lastDomainElem=d[lastDomainIdx],temp;if(lastDomainElem<firstDomainElem){temp=firstDomainIdx;firstDomainIdx=lastDomainIdx;lastDomainIdx=temp;temp=firstDomainElem;firstDomainElem=lastDomainElem;lastDomainElem=temp}d[firstDomainIdx]=interval.floor(firstDomainElem);d[lastDomainIdx]=interval.ceil(lastDomainElem);return d};var ScaleCalendar=function(_ScaleContinuous){(0,_inheritsLoose2.default)(ScaleCalendar,_ScaleContinuous);function ScaleCalendar(year,month,week,day,hour,minute,second,millisecond){var _this;_this=_ScaleContinuous.call(this,_continuous.deInterpolateLinear,_number.default)||this;_this.timeIntervals={year:year,month:month,week:week,day:day,hour:hour,minute:minute,second:second,millisecond:millisecond};_this.unclippedTimeIntervals={year:year,month:month,week:week,day:day,hour:hour,minute:minute,second:second,millisecond:millisecond};_this.tickIntervals=[[_this.timeIntervals.second,1,durationSecond],[_this.timeIntervals.second,5,5*durationSecond],[_this.timeIntervals.second,15,15*durationSecond],[_this.timeIntervals.second,30,30*durationSecond],[_this.timeIntervals.minute,1,durationMinute],[_this.timeIntervals.minute,5,5*durationMinute],[_this.timeIntervals.minute,15,15*durationMinute],[_this.timeIntervals.minute,30,30*durationMinute],[_this.timeIntervals.hour,1,durationHour],[_this.timeIntervals.hour,3,3*durationHour],[_this.timeIntervals.hour,6,6*durationHour],[_this.timeIntervals.hour,12,12*durationHour],[_this.timeIntervals.day,1,durationDay],[_this.timeIntervals.day,2,2*durationDay],[_this.timeIntervals.week,1,durationWeek],[_this.timeIntervals.month,1,durationMonth],[_this.timeIntervals.month,3,3*durationMonth],[_this.timeIntervals.year,1,durationYear]];_this.locale=_enUS.default;_this._localeConverter=new _timeConverter.TimeConverter(_enUS.default);return _this}var _proto=ScaleCalendar.prototype;_proto.setDomain=function setDomain(domain){return _ScaleContinuous.prototype.setDomain.call(this,domain.map(number))};_proto.setTimeInterval=function setTimeInterval(timeIntervals){this.timeIntervals=timeIntervals};_proto.setUnclippedTimeIntervals=function setUnclippedTimeIntervals(unclippedTimeIntervals){this.unclippedTimeIntervals=unclippedTimeIntervals};_proto.getDomain=function getDomain(){return _ScaleContinuous.prototype.getDomain.call(this).map(date)};_proto.ticks=function ticks(interval,count){var domain=_ScaleContinuous.prototype.getDomain.call(this);return(0,_ticks.default)(domain[0],domain[domain.length-1],interval,count,this.tickIntervals,this.timeIntervals)};_proto.nice=function nice(interval,count){var d=_ScaleContinuous.prototype.getDomain.call(this),i=(0,_ticks.tickInterval)(d[0],d[d.length-1],interval,count,this.tickIntervals,this.timeIntervals);return i?_ScaleContinuous.prototype.setDomain.call(this,_nice(d,i)):this};_proto.getDomainValue=function getDomainValue(range){return new Date(_ScaleContinuous.prototype.getDomainValue.call(this,range))};_proto.setLocale=function setLocale(locale){if(locale===void 0){locale=_enUS.default}this.locale=locale;this._localeConverter=new _timeConverter.TimeConverter(this.locale);return this};_proto.copy=function copy(){var _this$timeIntervals=this.timeIntervals,year=_this$timeIntervals.year,month=_this$timeIntervals.month,week=_this$timeIntervals.week,day=_this$timeIntervals.day,hour=_this$timeIntervals.hour,minute=_this$timeIntervals.minute,second=_this$timeIntervals.second,millisecond=_this$timeIntervals.millisecond;return(0,_continuous.copyScale)(this,new ScaleCalendar(year,month,week,day,hour,minute,second,millisecond))};return ScaleCalendar}(_continuous.default);var _default=ScaleCalendar;exports.default=_default;