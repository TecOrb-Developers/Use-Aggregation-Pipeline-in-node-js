"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _index=_interopRequireDefault(require("../../../../fusioncharts/core/index"));var _index2=_interopRequireDefault(require("./index"));var _fcDatatable=_interopRequireDefault(require("../../../../fc-datatable"));var _utitilies=require("../../../../../dev-tests/viz/utitilies");var EIMethods=["getCurrentBin","setCurrentBin","getTimeSelection","setTimeSelection","getBinning","setBinning"];_index.default.addDep(_index2.default);var data=[["2016-10-30 09:00:00","2018-10-30 09:00:00",1,"A",2,13],["2016-10-30 09:30:00","2018-10-30 09:30:00",20,"A",3,49],["2016-10-30 10:00:00","2018-10-30 10:00:00",3,"B",4,25],["2016-10-30 10:30:00","2018-10-30 10:30:00",14,"B",5,60],["2016-10-30 11:00:00","2018-10-30 11:00:00",50,"C",6,17],["2016-10-30 11:30:00","2018-10-30 11:30:00",26,"C",7,80]],schema=[{name:"Time",type:"date",format:"%Y-%m-%d %H:%M:%S"},{name:"Time-2",type:"date",format:"%Y-%m-%d %H:%M:%S"},{name:"Measure1",type:"number"},{name:"Item",type:"string"},{name:"Measure2",type:"number"},{name:"Measure3",type:"number"}];var fusionDataStore=new _fcDatatable.default,fusionTable=fusionDataStore.createDataTable(data,schema);describe("Representation of predictive data",(function(){var PREDICTIVE_LINE_COLOR="#00ff00",chartData={type:"timeseries",renderAt:_utitilies.CONTAINER_ID,width:600,height:400,dataSource:{chart:{},data:fusionTable}};var chart;beforeEach((function(){chart=(0,_utitilies.setup)(_index.default,chartData)}));afterEach((function(){return chart.dispose()}));it("No predictive path will be drawn when prediction extension is not added",(function(done){var renderComplete=function renderComplete(){var linePaths=document.querySelectorAll("[class$=-line-plot-meso]")[0].children;expect(linePaths.length).toBe(1);done()};chart.addEventListener("renderComplete",renderComplete);chart.render()}));it("Shows predictive style for plots on or after the given predicted date",(function(done){var renderComplete=function renderComplete(){var linePaths=document.querySelectorAll("[class$=-line-plot-meso]")[0].children;expect(linePaths.length).toBe(2);expect(linePaths.item(0).attributes.stroke.value).not.toBe(PREDICTIVE_LINE_COLOR);expect(linePaths.item(1).attributes.stroke.value).toBe(PREDICTIVE_LINE_COLOR);done()};chartData.dataSource["extensions"]={prediction:{date:"2016-10-30 09:30:00",style:{line:{stroke:PREDICTIVE_LINE_COLOR}}}};chart=(0,_utitilies.setup)(_index.default,chartData);chart.addEventListener("renderComplete",renderComplete);chart.render()}))}));describe("EI Method test",(function(){var chartData={type:"timeseries",renderAt:_utitilies.CONTAINER_ID,width:600,height:400,dataSource:{chart:{},data:fusionTable}};var chart=(0,_utitilies.setup)(_index.default,chartData);afterEach((function(){return chart.dispose()}));it("EI methods test",(function(done){var renderComplete=function renderComplete(e){var iapi=e.sender;for(var index=0;index<EIMethods.length;index++){var method=EIMethods[index];expect(iapi[method]).toBeDefined()}done()};chart.addEventListener("renderComplete",renderComplete);chart.render()}))}));describe("GridBands along yAxis",(function(){var chartData={type:"timeseries",renderAt:_utitilies.CONTAINER_ID,width:600,height:400,dataSource:{chart:{animation:0},data:fusionTable,yAxis:{showgridband:1}}};var chart=(0,_utitilies.setup)(_index.default,chartData);it("GridBands should be shown",(function(done){var renderComplete=function renderComplete(e){var rects=document.querySelector("svg").querySelector("[class*=grid-band-group]").getElementsByTagName("rect");expect(rects.length>0).toBeTruthy();done()};chart.addEventListener("renderComplete",renderComplete);chart.render()}));it("GridBands should not be shown",(function(done){chartData.dataSource.yAxis.showgridband=null;chart=(0,_utitilies.setup)(_index.default,chartData);var renderComplete=function renderComplete(e){var bandGroup=document.querySelector("svg").querySelector("[class*=grid-band]");expect(bandGroup).toBeNull();done()};chart.addEventListener("renderComplete",renderComplete);chart.render()}))}));