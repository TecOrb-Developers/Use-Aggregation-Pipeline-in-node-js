"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _spreadsheet=_interopRequireDefault(require("./xlgenerator/spreadsheet"));var _xlutil=require("./xlgenerator/xlutil");var _jszip=_interopRequireDefault(require("../_internal/vendors/jszip/dist/jszip"));var _lib=require("@fusioncharts/core/src/lib");function exportJSONtoEXCEL(obj){var sh=new _spreadsheet.default,zip,xl;sh.addSheet("Exported Data");var cellValue=_lib.BLANKSTRING;for(var rowindex=0;rowindex<obj.length;rowindex++){for(var columnindex=0;columnindex<obj[rowindex].length;columnindex++){cellValue=obj[rowindex][columnindex];if(typeof cellValue==="object"&&cellValue.value!==_lib.UNDEF)cellValue=cellValue.value;else if(cellValue!==_lib.UNDEF&&cellValue.length);else cellValue="";sh.createCell({sheet:0,row:rowindex,column:columnindex,value:cellValue})}}zip=new _jszip.default;zip.file("_rels/.rels",(0,_xlutil.createWorkBookRel)());xl=zip.folder("xl");xl.file("workbook.xml",sh.createWorkBook());xl.file("styles.xml",(0,_xlutil.getStyles)());xl.file("_rels/workbook.xml.rels",sh.createworkBookRels());zip.file("[Content_Types].xml",sh.createContentType());sh.fileSheets(xl);return zip.generateAsync({type:"blob",mimeType:"application/vnd.ms-excel"})}var _default={extension:exportJSONtoEXCEL,name:"ExcelExport",type:"extension",requiresFusionCharts:false};exports.default=_default;