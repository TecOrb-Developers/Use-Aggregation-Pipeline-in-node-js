"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _lib=require("@fusioncharts/core/src/lib");var _column=_interopRequireWildcard(require("@fusioncharts/charts/src/dataset/column"));var _dependencyManager=require("@fusioncharts/core/src/dependency-manager");var _index=_interopRequireDefault(require("./index.animation"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}var HUNDREDSTRING="100",PLOTBORDERCOLOR="plotBorderColor",PLOTGRADIENTCOLOR="plotGradientColor",COMMA=",",BLANK="",SHOWSHADOW="showShadow",NONE="none",MAX_MITER_LINEJOIN=2,M="M",H="H",UNDEF;(0,_dependencyManager.addDep)({name:"waterFall2DAnimation",type:"animationRule",extension:_index.default});var WaterFall2DDataset=function(_ColumnDataset){(0,_inheritsLoose2.default)(WaterFall2DDataset,_ColumnDataset);function WaterFall2DDataset(){return _ColumnDataset.apply(this,arguments)||this}var _proto=WaterFall2DDataset.prototype;_proto.getType=function getType(){return"dataset"};_proto.getName=function getName(){return"waterFall2D"};_proto.configure=function configure(datasetJSON){if(!datasetJSON){return false}this.trimData(datasetJSON);this.config.JSONData=datasetJSON;var catData,catObj,dataSet=this,chart=dataSet.getFromEnv("chart"),conf=dataSet.config,JSONData=dataSet.config.JSONData,setDataArr=JSONData.data,setDataLen=setDataArr&&setDataArr.length,catLen=dataSet.getFromEnv("xAxis").getTicksLen(),len=Math.min(catLen,setDataLen),chartAttr=chart.getFromEnv("dataSource").chart,colorM=dataSet.getFromEnv("color-manager"),showplotborder,plotColor=colorM.getPlotColor(dataSet.index||dataSet.positionIndex),plotBorderDash=(0,_lib.pluckNumber)(JSONData.dashed,chartAttr.plotborderdashed,0),chartConfig=chart.config,usePlotGradientColor=chartConfig.useplotgradientcolor,showTooltip=(0,_lib.pluckNumber)(chartAttr.showtooltip,1),tooltipSepChar=(0,_lib.parseUnsafeString)((0,_lib.pluck)(chartAttr.tooltipsepchar,", ")),formatedVal,parserConfig,setTooltext,macroIndices,toolText,plotDashLen,plotDashGap,plotBorderThickness,isRoundEdges,showHoverEffect,plotfillAngle,plotFillAlpha,plotFillRatio,plotgradientcolor,plotBorderAlpha,plotBorderColor,plotBorderDashStyle,initailPlotBorderDashStyle,setData,setValue,dataObj,config,colorArr,hoverColor,hoverAlpha,hoverGradientColor,hoverRatio,hoverAngle,hoverBorderColor,hoverBorderAlpha,hoverBorderThickness,hoverBorderDashed,hoverBorderDashGap,hoverBorderDashLen,hoverDashStyle,hoverColorArr,dataStore=dataSet.components.data,numberFormatter=dataSet.getFromEnv("number-formatter"),toolTipValue,setDisplayValue,isBar=false,is3D=false,isStacked=false,stack100Percent,enableAnimation,parentYAxis,setDataDashed,setDataPlotDashLen,setDataPlotDashGap,i,reflowData={},reflowDataObj=reflowData.dataObj||(reflowData.dataObj={}),reflowChartObj=reflowDataObj.chart||(reflowDataObj.chart={}),lineThickness=(0,_lib.pluck)(chartAttr.connectorthickness,1),showSum,dataLabel,showLabel,itemValue,maxValue=-Infinity,minValue=Infinity,seriesSum=0,total=0,lastComTotal=0,issum,zLine,setColor,cumulative,sumObj,countPoint,plotfillangle;conf.minAbsNonZeroValue=Infinity;conf.minAbsNonZeroData={};dataSet.setState("visible",(0,_lib.pluckNumber)(JSONData.visible,!Number(JSONData.initiallyhidden),1)===1);showplotborder=conf.showplotborder=(0,_lib.pluckNumber)(chartAttr.showplotborder,is3D?0:1);conf.plotBorderThickness=plotBorderThickness=showplotborder?is3D?1:(0,_lib.pluckNumber)(chartAttr.plotborderthickness,1):0;conf.isRoundEdges=isRoundEdges=(0,_lib.pluckNumber)(chartAttr.useroundedges,0);conf.plotBorderAlpha=plotBorderAlpha=showplotborder?(0,_lib.pluck)(chartAttr.plotborderalpha,plotFillAlpha,HUNDREDSTRING):0;conf.plotbordercolor=plotBorderColor=(0,_lib.pluck)(chartAttr.plotbordercolor,is3D?"#ffffff":colorM.getColor(PLOTBORDERCOLOR).split(COMMA)[0]);conf.plotgradientcolor=plotgradientcolor=usePlotGradientColor?(0,_lib.getDefinedColor)(chartAttr.plotgradientcolor,colorM.getColor(PLOTGRADIENTCOLOR)):BLANK;conf.plotDashLen=plotDashLen=(0,_lib.pluckNumber)(chartAttr.plotborderdashlen,6);conf.showTextOutline=(0,_lib.pluckNumber)(chartAttr.textoutline,0);conf.plotDashGap=plotDashGap=(0,_lib.pluckNumber)(chartAttr.plotborderdashgap,3);conf.use3DLighting=(0,_lib.pluckNumber)(chartAttr.use3dlighting,1);conf.showSum=showSum=(0,_lib.pluckNumber)(chartAttr.showsumatend,1);conf.plotColor=plotColor=(0,_lib.pluck)(JSONData.color,plotColor);conf.plotfillAngle=plotfillAngle=(0,_lib.pluckNumber)(360-chartAttr.plotfillangle,90);conf.showShadow=isRoundEdges||is3D?(0,_lib.pluckNumber)(chartAttr.showshadow,1):(0,_lib.pluckNumber)(chartAttr.showshadow,colorM.getColor(SHOWSHADOW));conf.usePattern=(0,_lib.pluckNumber)(chartConfig.usePattern,0);conf.patternType=_column.PATTERN_TYPES.includes(JSONData.patterntype)?JSONData.patterntype:chartConfig.patternType;conf.patternDensity=(0,_lib.pluckNumber)(JSONData.patterndensity,chartConfig.patternDensity);conf.patternAlpha=(0,_lib.pluckNumber)(JSONData.patternalpha,chartConfig.patternAlpha);conf.patternBgColor=(0,_lib.pluck)(JSONData.patternbgcolor,conf.patternBgColor);conf.showHoverEffect=showHoverEffect=(0,_lib.pluckNumber)(chartAttr.plothovereffect,chartAttr.showhovereffect,UNDEF);conf.usePattern&&(conf.showHoverEffect=showHoverEffect=0);conf.plotFillAlpha=plotFillAlpha=(0,_lib.pluck)(JSONData.alpha,chartAttr.plotfillalpha,HUNDREDSTRING);conf.plotRadius=(0,_lib.pluckNumber)(chartAttr.useRoundEdges,conf.isRoundEdges?1:0);conf.plotFillRatio=plotFillRatio=(0,_lib.pluck)(JSONData.ratio,chartAttr.plotfillratio);conf.dashed=plotBorderDash;conf.plotBorderDashStyle=initailPlotBorderDashStyle=plotBorderDash?(0,_lib.getDashStyle)(plotDashLen,plotDashGap):"none";conf.showValues=(0,_lib.pluckNumber)(JSONData.showvalues,chartAttr.showvalues,1);conf.valuePadding=(0,_lib.pluckNumber)(chartAttr.valuepadding,2);conf.enableAnimation=enableAnimation=(0,_lib.pluckNumber)(chartAttr.animation,chartAttr.defaultanimation,1);conf.animation=!enableAnimation?false:{duration:(0,_lib.pluckNumber)(chartAttr.animationduration,1)*1e3};reflowChartObj.transposeAnimation=conf.transposeAnimation=(0,_lib.pluckNumber)(chartAttr.transposeanimation,reflowChartObj.transposeAnimation,enableAnimation);conf.transposeAnimDuration=(0,_lib.pluckNumber)(chartAttr.transposeanimduration,.2)*1e3;conf.showTooltip=(0,_lib.pluckNumber)(chartAttr.showtooltip,1);conf.stack100Percent=stack100Percent=(0,_lib.pluckNumber)(chart.stack100percent,chartAttr.stack100percent,0);conf.definedGroupPadding=Math.max((0,_lib.pluckNumber)(chartAttr.plotspacepercent),0);conf.plotSpacePercent=Math.max((0,_lib.pluckNumber)(chartAttr.plotspacepercent,20)%100,0);conf.maxColWidth=(0,_lib.pluckNumber)(isBar?chartAttr.maxbarheight:chartAttr.maxcolwidth,50);conf.showPercentValues=(0,_lib.pluckNumber)(chartAttr.showpercentvalues,isStacked&&stack100Percent?1:0);conf.showPercentInToolTip=(0,_lib.pluckNumber)(chartAttr.showpercentintooltip,isStacked&&stack100Percent?1:0);conf.plotPaddingPercent=(0,_lib.pluckNumber)(chartAttr.plotpaddingpercent);conf.rotateValues=(0,_lib.pluckNumber)(chartAttr.rotatevalues)?270:0;conf.placeValuesInside=(0,_lib.pluckNumber)(chartAttr.placevaluesinside,0);conf.parentYAxis=parentYAxis=(0,_lib.pluck)(JSONData.parentyaxis&&JSONData.parentyaxis.toLowerCase(),"p")==="s"?1:0;conf.defaultPadding={left:.5,right:.5};dataSet.setState("dirty",true);if(!dataStore){dataStore=dataSet.components.data=[]}conf.zLine=zLine={step:true,data:[],dashStyle:chartAttr.connectordashed==="1"?(0,_lib.getDashStyle)((0,_lib.pluckNumber)(chartAttr.connectordashlen,2),(0,_lib.pluckNumber)(chartAttr.connectordashgap,2)):NONE,useForwardSteps:true,color:(0,_lib.convertColor)((0,_lib.pluck)(chartAttr.connectorcolor,"000000"),(0,_lib.pluck)(chartAttr.connectoralpha,100)),lineWidth:lineThickness};for(i=0;i<len;i+=1){setData=setDataArr[i];itemValue=numberFormatter.getCleanValue(setData.value);issum=(0,_lib.pluckNumber)(setData.issum,0);if(setData.vline||issum){delete setData._value;continue}seriesSum+=itemValue;setData._value=itemValue}if(showSum){showSum=true;len+=1;sumObj={label:(0,_lib.getFirstValue)(chartAttr.sumlabel,"Total"),_value:seriesSum,value:seriesSum,issum:1,cumulative:1}}for(i=0,countPoint=0;i<len;i+=1){setData=setDataArr[i];dataObj=dataStore[i];config=dataObj&&dataObj.config;if(!dataObj){dataObj=dataStore[i]={graphics:{}}}if(!dataObj.config){config=dataStore[i].config={}}if(!setData&&showSum){setData=setDataArr[i]=sumObj}plotColor=(0,_lib.pluck)(setData.color,colorM.getPlotColor(i));if(dataObj.vline){continue}itemValue=setData._value;delete setData._value;config.issum=issum=(0,_lib.pluckNumber)(setData.issum,0);cumulative=config.isCumulative=(0,_lib.pluckNumber)(setData.cumulative,1);if(issum){itemValue=cumulative?total:total===lastComTotal?total:total-lastComTotal;config.lastComTotal=lastComTotal;lastComTotal=total;zLine.data.push({y:null,x:countPoint-.5})}else{total+=itemValue}config.valuePadding=(0,_lib.pluckNumber)(setData.valuepadding,conf.valuePadding);maxValue=Math.max(maxValue,total);minValue=Math.min(minValue,total);if(itemValue!==0&&conf.minAbsNonZeroValue>Math.abs(itemValue)){conf.minAbsNonZeroValue=Math.abs(itemValue);conf.minAbsNonZeroData=config}config.total=total;showLabel=config.showLabel=(0,_lib.pluckNumber)(setData.showlabel,chartAttr.showlabels,1);dataLabel=config.dataLabel=(0,_lib.parseUnsafeString)(!showLabel?BLANK:(0,_lib.getFirstValue)(setData.label,setData.name));if(itemValue>0){setColor=(0,_lib.pluck)(setData.color,chartAttr.positivecolor,plotColor);if(showHoverEffect!==0){hoverColor=(0,_lib.pluck)(setData.positivehovercolor,chartAttr.positivehovercolor,chartAttr.plotfillhovercolor,chartAttr.columnhovercolor,setColor)}}else{setColor=(0,_lib.pluck)(setData.color,chartAttr.negativecolor,plotColor);if(showHoverEffect!==0){hoverColor=(0,_lib.pluck)(setData.negativehovercolor,chartAttr.negativehovercolor,chartAttr.plotfillhovercolor,chartAttr.columnhovercolor,setColor)}}if(itemValue<0){plotfillangle=360-plotfillAngle}else{plotfillangle=plotfillAngle}plotFillAlpha=(0,_lib.pluck)(setData.alpha,conf.plotFillAlpha);config.dashed=setDataDashed=(0,_lib.pluckNumber)(setData.dashed,conf.dashed);setDataPlotDashLen=(0,_lib.pluckNumber)(setData.dashlen,plotDashLen);setDataPlotDashGap=plotDashGap=(0,_lib.pluckNumber)(setData.dashgap,plotDashGap);config.plotFillAlpha=plotFillAlpha;config.plotBorderAlpha=plotBorderAlpha;config.showValue=(0,_lib.pluckNumber)(setData.showvalue,conf.showValues);config.setValue=setValue=itemValue;config.setLink=(0,_lib.pluck)(setData.link);config.toolTipValue=toolTipValue=numberFormatter.dataLabels(setValue,parentYAxis);config.setDisplayValue=setDisplayValue=(0,_lib.getValidValue)((0,_lib.parseUnsafeString)(setData.displayvalue));config.displayValue=(0,_lib.pluck)(setDisplayValue,toolTipValue);config.plotBorderDashStyle=plotBorderDashStyle=setDataDashed===1?(0,_lib.getDashStyle)(setDataPlotDashLen,setDataPlotDashGap):setDataDashed===0?"none":initailPlotBorderDashStyle;config.shadow={opacity:conf.showShadow?plotFillAlpha/100:0};config.dataLabelStyle=dataSet._configureDataLabelStyle(setData);config.patternType=_column.PATTERN_TYPES.includes(setData.patterntype)?setData.patterntype:conf.patternType;config.patternAngle=(0,_lib.pluckNumber)(setData.patternangle,JSONData.patternangle,chartAttr.patternangle,config.patternType===_column.PATTERN_TYPES[0]?40:0);config.patternDensity=(0,_lib.pluckNumber)(setData.patterndensity,conf.patternDensity);config.patternSize=(0,_lib.pluckNumber)(setData.patternsize,JSONData.patternsize,config.patternType===_column.PATTERN_TYPES[0]?2:4);config.patternAlpha=(0,_lib.pluckNumber)(setData.patternalpha,conf.patternAlpha);config.patternBgColor=(0,_lib.pluck)(setData.patternbgcolor,conf.patternBgColor);config.colorArr=colorArr=(0,_lib.getColumnColor)(setColor+COMMA+plotgradientcolor.replace(/,+?$/,""),plotFillAlpha,plotFillRatio,plotfillangle,isRoundEdges,plotBorderColor,plotBorderAlpha.toString(),isBar?1:0,!!is3D);if(showHoverEffect!==0){hoverAlpha=(0,_lib.pluck)(setData.alpha,setData.hoveralpha,JSONData.hoveralpha,chartAttr.plotfillhoveralpha,chartAttr.columnhoveralpha,plotFillAlpha);hoverGradientColor=(0,_lib.pluck)(setData.hovergradientcolor,JSONData.hovergradientcolor,chartAttr.plothovergradientcolor,plotgradientcolor);!hoverGradientColor&&(hoverGradientColor="");hoverRatio=(0,_lib.pluck)(setData.hoverratio,JSONData.hoverratio,setData.ratio,chartAttr.plothoverratio,plotFillRatio);hoverAngle=(0,_lib.pluckNumber)(360-setData.hoverangle,360-JSONData.hoverangle,360-chartAttr.plothoverangle,plotfillangle);hoverBorderColor=(0,_lib.pluck)(setData.borderhovercolor,JSONData.borderhovercolor,chartAttr.plotborderhovercolor,plotBorderColor);hoverBorderAlpha=(0,_lib.pluck)(setData.borderhoveralpha,JSONData.borderhoveralpha,chartAttr.plotborderhoveralpha,plotBorderAlpha,plotFillAlpha);hoverBorderThickness=(0,_lib.pluckNumber)(setData.borderhoverthickness,JSONData.borderhoverthickness,chartAttr.plotborderhoverthickness,plotBorderThickness);hoverBorderDashed=(0,_lib.pluckNumber)(setData.borderhoverdashed,JSONData.borderhoverdashed,chartAttr.plotborderhoverdashed);hoverBorderDashGap=(0,_lib.pluckNumber)(setData.borderhoverdashgap,JSONData.borderhoverdashgap,chartAttr.plotborderhoverdashgap,plotDashLen);hoverBorderDashLen=(0,_lib.pluckNumber)(setData.borderhoverdashlen,JSONData.borderhoverdashlen,chartAttr.plotborderhoverdashlen,plotDashGap);hoverDashStyle=hoverBorderDashed?(0,_lib.getDashStyle)(hoverBorderDashLen,hoverBorderDashGap):plotBorderDashStyle;if(showHoverEffect===1&&hoverColor===plotColor){hoverColor=(0,_lib.getLightColor)(hoverColor,70)}config.hoverColor=hoverColor;config.hoverAlpha=hoverAlpha;config.hoverBorderColor=hoverBorderColor;config.hoverBorderAlpha=hoverBorderAlpha;hoverColorArr=(0,_lib.getColumnColor)(hoverColor+","+hoverGradientColor,hoverAlpha,hoverRatio,hoverAngle,isRoundEdges,hoverBorderColor,hoverBorderAlpha.toString(),isBar?1:0,!!is3D);config.setRolloutAttr={fill:!is3D?(0,_lib.toRaphaelColor)(colorArr[0]):[(0,_lib.toRaphaelColor)(colorArr[0]),!conf.use3DLighting],stroke:showplotborder&&(0,_lib.toRaphaelColor)(colorArr[1]),"stroke-width":plotBorderThickness,"stroke-dasharray":plotBorderDashStyle};config.setRolloverAttr={fill:!is3D?(0,_lib.toRaphaelColor)(hoverColorArr[0]):[(0,_lib.toRaphaelColor)(hoverColorArr[0]),!conf.use3DLighting],stroke:showplotborder&&(0,_lib.toRaphaelColor)(hoverColorArr[1]),"stroke-width":hoverBorderThickness,"stroke-dasharray":hoverDashStyle}}formatedVal=config.toolTipValue;config.origToolText=setTooltext=(0,_lib.getValidValue)((0,_lib.parseUnsafeString)((0,_lib.pluck)(setData.tooltext,JSONData.plottooltext,chartAttr.plottooltext),false));if(!showTooltip){toolText=false}else if(setTooltext!==UNDEF){macroIndices=[1,2,3,5,6,7,20,21,24,25];parserConfig={formattedValue:formatedVal,label:dataLabel,yaxisName:(0,_lib.parseUnsafeString)(chartAttr.yaxisname),xaxisName:(0,_lib.parseUnsafeString)(chartAttr.xaxisname),cumulativeValue:total,cumulativeDataValue:numberFormatter.dataLabels(total),sum:numberFormatter.dataLabels(seriesSum),unformattedSum:seriesSum};toolText=(0,_lib.parseTooltext)(setTooltext,macroIndices,parserConfig,setData,chartAttr,JSONData)}else{toolText=formatedVal===null?false:dataLabel!==BLANK?dataLabel+tooltipSepChar:""}zLine.data.push({y:itemValue===null?null:total,x:countPoint});countPoint+=1;config.originalPlotColor=(0,_lib.hashify)(plotColor);config.toolText=toolText;config.setTooltext=toolText;config._x=i;config._y=setValue}conf.maxValue=maxValue;conf.minValue=minValue;conf.connectNullData=(0,_lib.pluckNumber)(chartAttr.connectnulldata,0);conf.showConnectors=(0,_lib.pluckNumber)(chartAttr.showconnectors,1);catData=JSONData.catData;for(i=0;i<catData.length;i+=1){catObj=catData[i];setDataArr.splice(catObj.index,0,catObj.data)}dataSet.getFromEnv("xAxis").setTickValues(setDataArr);dataSet.config.maxminFlag=false};_proto.createCoordinates=function createCoordinates(){var dataSet=this,isBar=dataSet.getFromEnv("chart").isBar,yAxis=dataSet.getFromEnv("yAxis"),xAxis=dataSet.getFromEnv("xAxis"),yBase=yAxis.getAxisBase(),yBasePos=yAxis.getPixel(yBase),dataObj,config,previousY,i,Px,Py,Pb,yVal,chartConfig=dataSet.getFromEnv("chartConfig"),xDepth=chartConfig.xDepth||0,yDepth=chartConfig.yDepth||0,len=dataSet.components.data.length,groupManager=dataSet.groupManager,stackConf=groupManager&&groupManager.stackConf,dataStore=dataSet.components.data;!isBar&&(xDepth=-xDepth);isBar&&(yDepth=-yDepth);for(i=0;i<len;i++){dataObj=dataStore[i];config=dataObj&&dataObj.config;if(dataObj===UNDEF){continue}yVal=config._y;if(!config.issum){previousY=dataStore[i-1]&&dataStore[i-1].config.total;previousY&&(yVal+=previousY)}else if(!config.isCumulative){previousY=config.lastComTotal;yVal+=config.lastComTotal}else{previousY=null}Px=xAxis.getPixel(stackConf&&stackConf[i].x||config._x)+xDepth;Py=yAxis.getPixel(yVal)+yDepth;Pb=(previousY?yAxis.getPixel(previousY):yBasePos)+yDepth;if(xAxis.config.isVertical){config._Px=Py;config._Py=Px;config._Pby=Px;config._Pbx=Pb}else{config._Px=Px;config._Py=Py;config._Pby=Pb;config._Pbx=Px}}};_proto.getDataLimits=function getDataLimits(){var dataSet=this,dataStore=dataSet.components.data,conf=dataSet.config,i,config,len=dataStore.length,setValue,maxValue=-Infinity,minValue=+Infinity;for(i=0;i<len;i++){if(!dataStore[i]){continue}config=dataStore[i].config;setValue=config.total;if(setValue!==UNDEF){maxValue=Math.max(maxValue,setValue);minValue=Math.min(minValue,setValue)}}conf.maxValue=maxValue;conf.minValue=minValue;return{max:conf.maxValue,min:conf.minValue}};_proto.drawPlots=function drawPlots(anim){var dataSet=this;_ColumnDataset.prototype.drawPlots.call(this,anim);if(dataSet.config.showConnectors){dataSet.drawLine()}else{dataSet.getContainer("commonElemsGroup").hide()}};_proto.drawLine=function drawLine(){var dataSet=this,conf=dataSet.config,i,yPos,xPos,yAxis=dataSet.getFromEnv("yAxis"),yBase=yAxis.getAxisBase(),yBasePos=yAxis.getPixel(yBase),lineContainer=dataSet.getContainer("commonElemsGroup"),groupNetHalfWidth=dataSet.getFromEnv("columnWidth")/2,zLineConf=conf.zLine,data=zLineConf.data,set,y,x,ln=data.length,seriesLineWidth=zLineConf.lineWidth,lastXPos,zLineDummy=dataSet._graphics.zLine,zLine,lastYPos=null,linePath=[],lastMoveCommand=[];yAxis.yBasePos=yBasePos;lineContainer.toFront().show();for(i=0;i<ln;i+=1){set=data[i];y=set.y;if(y===null){lastMoveCommand.length=0;if(conf.connectNullData===0){lastYPos=null}}else{x=(0,_lib.pluckNumber)(set.x,i);yPos=yAxis.getPixel(y);xPos=dataSet.getFromEnv("xAxis").getPixel(x);xPos=(0,_lib.getCrispValue)(xPos,seriesLineWidth,seriesLineWidth).position;yPos=(0,_lib.getCrispValue)(yPos,seriesLineWidth,seriesLineWidth).position;if(lastYPos!==null){if(lastMoveCommand.length){linePath=linePath.concat(lastMoveCommand);lastMoveCommand.length=0}linePath.push(M,lastXPos,lastYPos,"m",-groupNetHalfWidth,0,H,xPos,"h",groupNetHalfWidth,"m",0,yPos-lastYPos)}else{lastMoveCommand.push(M,xPos,yPos)}lastXPos=xPos;lastYPos=yPos}}zLine=dataSet.getFromEnv("animationManager").setAnimation({el:zLineDummy||"path",attr:{path:linePath,"stroke-linecap":"round","stroke-opacity":1,"stroke-dasharray":zLineConf.dashStyle,stroke:zLineConf.color,"stroke-linejoin":seriesLineWidth>=MAX_MITER_LINEJOIN?"round":"miter","stroke-width":seriesLineWidth},container:lineContainer,component:dataSet,label:"path"});if(!zLineDummy){dataSet.addGraphicalElement("zLine",zLine)}};return WaterFall2DDataset}(_column.default);var _default=WaterFall2DDataset;exports.default=_default;