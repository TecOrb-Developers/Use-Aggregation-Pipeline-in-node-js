"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _waterfall2d=_interopRequireDefault(require("../waterfall2d"));var _kagi=_interopRequireDefault(require("../../dataset/kagi"));var _lib=require("@fusioncharts/core/src/lib");var UNDEF,HUNDREDSTRING="100",SEVENTYSTRING="70",KAGI="kagi";var Kagi=function(_WaterFall2D){(0,_inheritsLoose2.default)(Kagi,_WaterFall2D);function Kagi(){return _WaterFall2D.apply(this,arguments)||this}Kagi.getName=function getName(){return"Kagi"};var _proto=Kagi.prototype;_proto.getName=function getName(){return"Kagi"};_proto.__setDefaultConfig=function __setDefaultConfig(){_WaterFall2D.prototype.__setDefaultConfig.call(this);var config=this.config;config.singleseries=true;config.hasLegend=false;config.defaultDatasetType=KAGI;config.setAdaptiveMin=true;config.anchorborderthickness=1;config.anchorimageurl=UNDEF;config.anchorimagepadding=1;config.anchorsides=1;config.anchoralpha=UNDEF;config.anchorbgalpha=HUNDREDSTRING;config.anchorimagealpha=HUNDREDSTRING;config.anchorimagescale=100;config.anchorstartangle=90;config.anchorshadow=0;config.anchorbgcolor=UNDEF;config.anchorbordercolor=UNDEF;config.anchorradius=3;config.showvalues=1;config.plotfillalpha=SEVENTYSTRING;config.linedashlen=5;config.linedashgap=4;config.linedashed=UNDEF;config.linealpha=HUNDREDSTRING;config.linethickness=2;config.drawfullareaborder=1;config.connectnulldata=0;config.zeroplanethickness=1;config.enablemousetracking=true;config.zeroplanealpha=40;config.showzeroplaneontop=0};_proto._getDataset=function _getDataset(){var dataSetArr=[];this.iterateComponents((function(child){if(child.getType&&child.getType()==="dataset"){dataSetArr.push(child)}}));return dataSetArr};_proto._postSpaceManagement=function _postSpaceManagement(){var iapi=this,config=iapi.config,xAxis=iapi.getChildren("xAxis")[0],yAxis=iapi.getChildren("yAxis")[0],canvas=iapi.getChildren("canvas")[0],canvasConfig=canvas.config,canvasBorderWidth=canvasConfig.canvasBorderWidth,canvasPadding=(0,_lib.pluckNumber)(canvasConfig.canvasPadding,15),canvasPaddingTop=canvasConfig.canvasPaddingTop,canvasPaddingBottom=canvasConfig.canvasPaddingBottom,canvasPaddingLeft=canvasConfig.canvasPaddingLeft,canvasPaddingRight=canvasConfig.canvasPaddingRight,chartAttrs=iapi.getFromEnv("dataSource").chart,series=iapi._getDataset()[0].config,shiftCount=series&&series.shiftCount,min=(0,_lib.pluckNumber)(xAxis.getAxisConfig("axisMinValue"),0),max=(0,_lib.pluckNumber)(xAxis.getAxisConfig("axisMaxValue"),shiftCount-1),maxHShiftPercent=(0,_lib.pluckNumber)(chartAttrs.maxhshiftpercent,10),effectiveCanvasWidth=iapi.config.canvasWidth-canvasPadding*2,shift=config.shift||0,xShiftLength;yAxis&&yAxis.setAxisDimention({x:yAxis.config.isOpposit?config.canvasRight+canvasBorderWidth:config.canvasLeft-canvasBorderWidth,y:config.canvasTop+canvasPaddingTop,opposite:yAxis.config.isOpposit?config.canvasLeft-canvasBorderWidth:config.canvasRight+canvasBorderWidth,axisLength:config.canvasHeight-canvasPaddingTop-canvasPaddingBottom});iapi._setPosition();if(series){maxHShiftPercent=maxHShiftPercent<=0?10:maxHShiftPercent;xShiftLength=series.xShiftLength=Math.min(effectiveCanvasWidth/shiftCount,maxHShiftPercent*effectiveCanvasWidth/100);max=Math.max(max,1)}canvas.setCanvasPadding();xAxis&&xAxis.setAxisConfig({canvasPaddingLeft:Math.max(canvasPaddingLeft,canvasPadding)+xShiftLength/2,canvasPaddingRight:Math.max(canvasPaddingRight,canvasPadding)+xShiftLength/2});xAxis&&xAxis.setAxisDimention({x:iapi.config.canvasLeft+canvasPadding+xShiftLength/2,axisLength:xShiftLength*(max-min),y:xAxis.config.isOpposit?config.canvasTop-canvasBorderWidth:config.canvasBottom+shift+canvasBorderWidth,opposite:xAxis.config.isOpposit?config.canvasBottom+shift+canvasBorderWidth:config.canvasTop-canvasBorderWidth});iapi.allocateDimensionOfChartMenuBar()};_proto._setPosition=function _setPosition(){var i,point,yValue,isRally,lastHigh,lastLow,isRallyInitialised,lastPoint,iapi=this,dataObj=iapi.getFromEnv("dataSource"),dataSet=iapi._getDataset()[0],categories=dataObj.data||dataSet&&dataSet[0]&&dataSet[0].data,setDataArr=dataSet.components.data,dataSetLen=setDataArr&&setDataArr.length,yAxis=iapi.getChildren("yAxis")[0],xValue=0,plotX=xValue,catArr=[];for(i=0;i<dataSetLen;i++){point=setDataArr[i].config;yValue=point.setValue;dataObj=setDataArr[i];if(!dataObj){dataObj=setDataArr[i]={graphics:{}}}if(!point.isDefined){yValue=point.plotValue}yValue=(0,_lib.pluck)(point.plotValue,yValue);point.plotY=(0,_lib.toPrecision)(yAxis.getPixel(point.setValue),2);point.graphY=yValue&&(0,_lib.toPrecision)(yAxis.getPixel(yValue),2);point.plotX=plotX;if(point.isShift){xValue+=1;plotX=xValue;categories&&catArr.push(categories[i])}else if(i===dataSetLen-1){categories&&catArr.push(categories[i])}if(i){lastPoint=setDataArr[i-1].config;isRally=point&&point.objParams&&point.objParams.isRally;lastHigh=point&&point.objParams&&point.objParams.lastHigh;lastLow=point&&point.objParams&&point.objParams.lastLow;isRallyInitialised=point&&point.objParams&&point.objParams.isRallyInitialised;if(lastPoint&&isRallyInitialised&&lastPoint.isRally!==point.isRally){point.isChanged=true;point.ty=(0,_lib.toPrecision)(yAxis.getPixel(isRally?lastHigh:lastLow),2)}else{point.isChanged=false}}}};_proto.getDSdef=function getDSdef(){return _kagi.default};return Kagi}(_waterfall2d.default);var _default=Kagi;exports.default=_default;