"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _sunburstDataset=_interopRequireDefault(require("../../factories/sunburst-dataset"));var _multilevelpie=_interopRequireDefault(require("../multilevelpie"));var _lib=require("@fusioncharts/core/src/lib");var DEFAULT_PALETTE_COLOR=["1E77B4","FF7F0E","2BA02C","D62728","9466BD","8C564B","E376C2","7F7F7F","BCBD22","17BECF"],DEFAULT_BG_COLOR="FFFFFF,FFFFFF";var Sunburst=function(_MultilevelPie){(0,_inheritsLoose2.default)(Sunburst,_MultilevelPie);Sunburst.getName=function getName(){return"Sunburst"};function Sunburst(){var _this;_this=_MultilevelPie.call(this)||this;_this.defaultPaletteOptions={paletteColors:[DEFAULT_PALETTE_COLOR,DEFAULT_PALETTE_COLOR,DEFAULT_PALETTE_COLOR,DEFAULT_PALETTE_COLOR,DEFAULT_PALETTE_COLOR],bgColor:[DEFAULT_BG_COLOR,DEFAULT_BG_COLOR,DEFAULT_BG_COLOR,DEFAULT_BG_COLOR,DEFAULT_BG_COLOR]};_this.registerFactory("dataset",_sunburstDataset.default,["canvas"]);return _this}var _proto=Sunburst.prototype;_proto.__setDefaultConfig=function __setDefaultConfig(){_MultilevelPie.prototype.__setDefaultConfig.call(this);this.config.allowdrilltonode=1;this.config.showvaluesintooltip=1};_proto.configureAttributes=function configureAttributes(dataSource){_MultilevelPie.prototype.configureAttributes.call(this,dataSource);var chart=this;chart.config.allowdrilltonode=(0,_lib.pluckNumber)(dataSource.chart.allowdrilltonode,1);if(chart.config.allowdrilltonode){chart.addToEnv("linkClickFN",(function(){return null}))}};_proto.getName=function getName(){return"Sunburst"};_proto._checkInvalidSpecificData=function _checkInvalidSpecificData(){var parsedDS=this.parseAndSanitizeData();var i=0;if(!parsedDS||!Array.isArray(parsedDS)||parsedDS.length===0){return true}for(;i<parsedDS.length;i++){if(parsedDS[i].category&&parsedDS[i].category.length===0&&!parsedDS[i].value){return true}}};_proto.parseAndSanitizeData=function parseAndSanitizeData(){var categories=[],flatInput=[],tempMap={},chart=this,dataSource=(0,_lib.extend2)({},chart.getFromEnv("dataSource"));if(dataSource&&dataSource.data&&Array.isArray(dataSource.data)){flatInput=dataSource.data.map((function(item){tempMap[item.id]=item;!item.parent&&(item.isRootNode=true);!item.categories&&(item.category=[]);return item})).filter((function(item){if(item.id&&(!item.value||!isNaN(+item.value))){if(!item.parent||item.parent&&tempMap[item.parent]){return true}}delete tempMap[item.id];return false}));for(var key in tempMap){if(tempMap.hasOwnProperty(key)){var item=tempMap[key];if(item.parent){tempMap[item.parent].category.push(item)}if(item.isRootNode){categories.push(item)}}}chart.addToEnv("parsedDataSource",categories)}return flatInput};return Sunburst}(_multilevelpie.default);var _default=Sunburst;exports.default=_default;