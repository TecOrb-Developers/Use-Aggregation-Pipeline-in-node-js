"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _lib=require("@fusioncharts/core/src/lib");var _extent=_interopRequireDefault(require("@fusioncharts/utils/src/array/extent"));var _mscolumn2d=_interopRequireDefault(require("@fusioncharts/charts/src/chart/mscolumn2d"));var _scrollApis=require("@fusioncharts/charts/src/chart/_internal/utils/scroll-apis");var _boxandwhisker=_interopRequireDefault(require("../../dataset/boxandwhisker"));var _boxandwhiskerDataset=_interopRequireDefault(require("../../factories/boxandwhisker-dataset"));var _boxandwhiskerMultiseries=_interopRequireDefault(require("../../dataset/groups/boxandwhisker-multiseries"));_lib.setAttribDefs&&(0,_lib.setAttribDefs)({whiskerslimitswidthratio:{type:_lib.attrTypeNum,pAttr:"whiskerslimitswidthratio"},outliersupperrangeratio:{type:_lib.attrTypeNum,pAttr:"outliersupperrangeratio"},outlierslowerrangeratio:{type:_lib.attrTypeNum,pAttr:"outlierslowerrangeratio"},showalloutliers:{type:_lib.attrTypeNum,pAttr:"showalloutliers"},showmean:{type:_lib.attrTypeNum,pAttr:"showmean"},showsd:{type:_lib.attrTypeNum,pAttr:"showsd"},showmd:{type:_lib.attrTypeNum,pAttr:"showmd"},showqd:{type:_lib.attrTypeNum,pAttr:"showqd"},showminvalues:{type:_lib.attrTypeNum,pAttr:"showminvalues"},showmaxvalues:{type:_lib.attrTypeNum,pAttr:"showmaxvalues"},showq1values:{type:_lib.attrTypeNum,pAttr:"showq1values"},showq3values:{type:_lib.attrTypeNum,pAttr:"showq3values"},showmedianvalues:{type:_lib.attrTypeNum,pAttr:"showmedianvalues"}});var UNDEF,POLYGON=_lib.preDefStr.POLYGON,COLOR_000000=_lib.preDefStr.colors.c000000,BOXANDWHISKER_2D="boxandwhisker2d",ABOVE="above",COLON_STR=": ";var BoxAndWhisker2D=function(_MSColumn2D){(0,_inheritsLoose2.default)(BoxAndWhisker2D,_MSColumn2D);BoxAndWhisker2D.getName=function getName(){return"BoxAndWhisker2D"};var _proto=BoxAndWhisker2D.prototype;_proto.getName=function getName(){return"BoxAndWhisker2D"};BoxAndWhisker2D.includeInputOptions=function includeInputOptions(){return["SwipeGesture"]};function BoxAndWhisker2D(){var _this;_this=_MSColumn2D.call(this)||this;var iapi=(0,_assertThisInitialized2.default)(_this);iapi.maxColWidth=+Infinity;iapi.useErrorAnimation=1;iapi.avoidCrispError=0;iapi.plotSpacePercent=20;iapi.useplotgradientcolor=1;iapi.fireGroupEvent=true;iapi.hasScroll=true;iapi.eiMethods.scrollTo=_scrollApis.scrollTo;_this.registerFactory("dataset",_boxandwhiskerDataset.default,["vCanvas"]);return _this}_proto.__setDefaultConfig=function __setDefaultConfig(){_MSColumn2D.prototype.__setDefaultConfig.call(this);var config=this.config;config.avgScrollPointWidth=40;config.decimals=2;config.defaultDatasetType=BOXANDWHISKER_2D;config.showplotborder=1;config.plotborderdashlen=5;config.plotborderdashgap=4;config.plotfillalpha=_lib.HUNDREDSTRING;config.useroundedges=0;config.plotborderthickness=1;config.showvalues=1;config.valuepadding=2;config.decimals=2;config.showtooltip=1;config.maxcolwidth=50;config.rotatevalues=0;config.use3dlighting=1;config.whiskerslimitswidthratio=40;config.outliersupperrangeratio=0;config.outlierslowerrangeratio=0;config.showalloutliers=0;config.showmean=0;config.showsd=0;config.showmd=0;config.showqd=0;config.showminvalues=1;config.showmaxvalues=1;config.showq1values=0;config.showq3values=0;config.showmedianvalues=1;config.tooltipsepchar=COLON_STR;config.anchorborderthickness=1;config.anchorimageurl=UNDEF;config.anchorimagepadding=1;config.anchorsides=1;config.anchoralpha=UNDEF;config.anchorbgalpha=_lib.HUNDREDSTRING;config.anchorimagealpha=_lib.HUNDREDSTRING;config.anchorimagescale=100;config.anchorstartangle=90;config.anchorshadow=0;config.anchorbgcolor=UNDEF;config.anchorbordercolor=UNDEF;config.anchorradius=3;config.linedashlen=5;config.linedashgap=4;config.linedashed=UNDEF;config.linealpha=_lib.HUNDREDSTRING;config.linethickness=2;config.drawfullareaborder=1;config.connectnulldata=0};_proto.configureAttributes=function configureAttributes(dataObj){_MSColumn2D.prototype.configureAttributes.call(this,dataObj);_scrollApis.configurer.call(this,dataObj)};_proto._setAxisScale=function _setAxisScale(){_scrollApis.setAxisScale.call(this,BOXANDWHISKER_2D)};_proto._resetViewPortConfig=function _resetViewPortConfig(){_scrollApis.resetViewPortConfig.call(this)};_proto._getLineJSONdata=function _getLineJSONdata(){var iapi=this,bwCalc=iapi.getChildren("BoxAndWhiskerStatisticalCalc")[0],jsonData=iapi.getFromEnv("dataSource"),chartAttrs=jsonData.chart,datasets=jsonData.dataset,len=datasets.length,showMean,dataset,data,dataLen,setData,derivedDS=[],currDerivedDS,requiredSubDs=[],derivedDataValue=[],currDerivedDataVal,subDSLen,currSubDS,showSD,showQD,showMD,outliers,outliersArr,valueMin,valueMax,value,meanValue,sdValue,mdValue,qdValue,fn=function fn(val){value=Number(val);var _ref=bwCalc.values?(0,_extent.default)(bwCalc.values):[setData.min,setData.max];valueMin=_ref[0];valueMax=_ref[1];(value<valueMin||value>valueMax)&&outliersArr.push({showvalue:setData.showoutliervalue,valueposition:setData.outliervalueposition,value:value,index:j,anchorbgcolor:setData.outliericoncolor,anchorbordercolor:setData.outliericonbordercolor,anchorradius:setData.outliericonradius,anchoralpha:setData.outliericonalpha,anchorbgalpha:setData.outliericonalpha,anchorsides:setData.outliericonsides,dip:setData.outliericonshape})},j,k,i;for(i=0;i<len;i++){dataset=datasets[i];currSubDS=requiredSubDs[i]={};currDerivedDataVal=derivedDataValue[i]={showMean:{seriesname:"Mean",valueposition:(0,_lib.pluck)(dataset.meanvalueposition,chartAttrs.meanvalueposition,ABOVE),showvalues:(0,_lib.pluckNumber)(dataset.showmeanvalues,chartAttrs.showmeanvalues,0),anchorbgcolor:(0,_lib.pluck)(dataset.meaniconcolor,chartAttrs.meaniconcolor,COLOR_000000),anchorbordercolor:(0,_lib.pluck)(dataset.meaniconbordercolor,chartAttrs.meaniconbordercolor,COLOR_000000),anchorradius:(0,_lib.pluckNumber)(dataset.meaniconradius,chartAttrs.meaniconradius,5),anchoralpha:(0,_lib.pluck)(dataset.alpha,dataset.meaniconalpha,chartAttrs.meaniconalpha),linethickness:(0,_lib.pluck)(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:(0,_lib.pluck)(dataset.meaniconsides,chartAttrs.meaniconsides,3),showline:!(0,_lib.pluckNumber)(dataset.drawmeanconnector,chartAttrs.drawmeanconnector),dip:(0,_lib.pluck)(dataset.meaniconshape,chartAttrs.meaniconshape,POLYGON),color:(0,_lib.pluck)(dataset.meaniconcolor,chartAttrs.meaniconcolor,COLOR_000000),data:[]},showSD:{seriesname:"SD",valueposition:(0,_lib.pluck)(dataset.sdvalueposition,chartAttrs.sdvalueposition,ABOVE),showvalues:(0,_lib.pluckNumber)(dataset.showsdvalues,chartAttrs.showsdvalues,0),anchorbgcolor:(0,_lib.pluck)(dataset.sdiconcolor,chartAttrs.sdiconcolor,COLOR_000000),anchorbordercolor:(0,_lib.pluck)(dataset.sdiconbordercolor,chartAttrs.sdiconbordercolor,COLOR_000000),anchorradius:(0,_lib.pluckNumber)(dataset.sdiconradius,chartAttrs.sdiconradius,5),anchoralpha:(0,_lib.pluck)(dataset.alpha,dataset.sdiconalpha,chartAttrs.sdiconalpha),anchorbgalpha:(0,_lib.pluck)(dataset.sdiconalpha,chartAttrs.sdiconalpha,100),linethickness:(0,_lib.pluck)(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:(0,_lib.pluck)(dataset.sdiconsides,chartAttrs.sdiconsides,3),showline:!(0,_lib.pluckNumber)(dataset.drawsdconnector,chartAttrs.drawsdconnector),dip:(0,_lib.pluck)(dataset.sdiconshape,chartAttrs.sdiconshape,POLYGON),color:(0,_lib.pluck)(dataset.sdiconcolor,chartAttrs.sdiconcolor,COLOR_000000),data:[]},showQD:{seriesname:"QD",valueposition:(0,_lib.pluck)(dataset.qdvalueposition,chartAttrs.qdvalueposition,ABOVE),showvalues:(0,_lib.pluckNumber)(dataset.showqdvalues,chartAttrs.showqdvalues,0),anchorbgcolor:(0,_lib.pluck)(dataset.qdiconcolor,chartAttrs.qdiconcolor,COLOR_000000),anchorbordercolor:(0,_lib.pluck)(dataset.qdiconbordercolor,chartAttrs.qdiconbordercolor,COLOR_000000),anchorradius:(0,_lib.pluckNumber)(dataset.qdiconradius,chartAttrs.qdiconradius,5),anchoralpha:(0,_lib.pluck)(dataset.alpha,dataset.qdiconalpha,chartAttrs.qdiconalpha),anchorbgalpha:(0,_lib.pluck)(dataset.qdiconalpha,chartAttrs.qdiconalpha,100),linethickness:(0,_lib.pluck)(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:(0,_lib.pluck)(dataset.qdiconsides,chartAttrs.qdiconsides,3),showline:!(0,_lib.pluckNumber)(dataset.drawqdconnector,chartAttrs.drawqdconnector),dip:(0,_lib.pluck)(dataset.qdiconshape,chartAttrs.qdiconshape,POLYGON),color:(0,_lib.pluck)(dataset.qdiconcolor,chartAttrs.qdiconcolor,COLOR_000000),data:[]},showMD:{seriesname:"MD",valueposition:(0,_lib.pluck)(dataset.mdvalueposition,chartAttrs.mdvalueposition,ABOVE),showvalues:(0,_lib.pluckNumber)(dataset.showmdvalues,chartAttrs.showmdvalues,0),anchorbgcolor:(0,_lib.pluck)(dataset.mdiconcolor,chartAttrs.mdiconcolor,COLOR_000000),anchorbordercolor:(0,_lib.pluck)(dataset.mdiconbordercolor,chartAttrs.mdiconbordercolor,COLOR_000000),anchorradius:(0,_lib.pluckNumber)(dataset.mdiconradius,chartAttrs.mdiconradius,5),anchoralpha:(0,_lib.pluck)(dataset.alpha,dataset.mdiconalpha,chartAttrs.mdiconalpha),anchorbgalpha:(0,_lib.pluck)(dataset.mdiconalpha,chartAttrs.mdiconalpha,100),linethickness:(0,_lib.pluck)(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:(0,_lib.pluck)(dataset.mdiconsides,chartAttrs.mdiconsides,3),showline:!(0,_lib.pluckNumber)(dataset.drawmdconnector,chartAttrs.drawmdconnector),dip:(0,_lib.pluck)(dataset.mdiconshape,chartAttrs.mdiconshape,POLYGON),color:(0,_lib.pluck)(dataset.mdiconcolor,chartAttrs.mdiconcolor,COLOR_000000),data:[]},outliers:{seriesname:"Outliers",valueposition:(0,_lib.pluck)(dataset.outliervalueposition,chartAttrs.outliervalueposition,ABOVE),showvalues:(0,_lib.pluckNumber)(dataset.showoutliervalues,chartAttrs.showoutliervalues,0),anchorbgcolor:(0,_lib.pluck)(dataset.outliericoncolor,chartAttrs.outliericoncolor,COLOR_000000),anchorbordercolor:(0,_lib.pluck)(dataset.outliericonbordercolor,chartAttrs.outliericonbordercolor,COLOR_000000),anchorradius:(0,_lib.pluckNumber)(dataset.outliericonradius,chartAttrs.outliericonradius,5),anchoralpha:(0,_lib.pluck)(dataset.alpha,dataset.outliericonalpha,chartAttrs.outliericonalpha),includeinlegend:dataset.seriesname?1:0,anchorbgalpha:(0,_lib.pluck)(dataset.outliericonalpha,chartAttrs.outliericonalpha,100),linethickness:(0,_lib.pluck)(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:(0,_lib.pluck)(dataset.outliericonsides,chartAttrs.outliericonsides,3),showline:!(0,_lib.pluckNumber)(dataset.drawoutliersconnector,chartAttrs.drawoutliersconnector),color:(0,_lib.pluck)(dataset.outliericoncolor,chartAttrs.outliericoncolor,COLOR_000000),dip:(0,_lib.pluck)(dataset.outliericonshape,chartAttrs.outliericonshape,POLYGON),data:[]}};showMean=(0,_lib.pluckNumber)(dataset.showmean,chartAttrs.showmean,0);showSD=(0,_lib.pluckNumber)(dataset.showsd,chartAttrs.showsd,0);showQD=(0,_lib.pluckNumber)(dataset.showqd,chartAttrs.showqd,0);showMD=(0,_lib.pluckNumber)(dataset.showmd,chartAttrs.showmd,0);data=dataset.data;dataLen=data&&data.length||0;for(j=0;j<dataLen;j++){setData=data[j];if(setData.min&&setData.max&&setData.q1&&setData.q3&&setData.median){meanValue=setData.mean;sdValue=setData.sd;mdValue=setData.md;qdValue=setData.qd}else{bwCalc.setArray(setData.value);bwCalc.getQuartiles();meanValue=bwCalc.getMean();sdValue=bwCalc.getSD();qdValue=bwCalc.getQD();mdValue=bwCalc.getMD()}outliers=setData.outliers;showMean=currSubDS.showMean=currSubDS.showMean||(0,_lib.pluckNumber)(setData.showmean,showMean);showSD=currSubDS.showSD=currSubDS.showSD||(0,_lib.pluckNumber)(setData.showsd,showSD);showQD=currSubDS.showQD=currSubDS.showQD||(0,_lib.pluckNumber)(setData.showqd,showQD);showMD=currSubDS.showMD=currSubDS.showMD||(0,_lib.pluckNumber)(setData.showmd,showMD);currDerivedDataVal.showMean.data.push({showvalue:setData.showmeanvalue,valueposition:setData.meanvalueposition,value:showMean&&(meanValue||UNDEF),anchorbgcolor:setData.meaniconcolor,anchorbordercolor:setData.meaniconbordercolor,anchorradius:setData.meaniconradius,anchoralpha:setData.meaniconalpha,anchorbgalpha:setData.meaniconalpha,anchorsides:setData.meaniconsides,dip:setData.meaniconshape});currDerivedDataVal.showSD.data.push({showvalue:setData.showsdvalue,valueposition:setData.sdvalueposition,value:showSD&&(sdValue||UNDEF),anchorbgcolor:setData.sdiconcolor,anchorbordercolor:setData.sdiconbordercolor,anchorradius:setData.sdiconradius,anchoralpha:setData.sdiconalpha,anchorbgalpha:setData.sdiconalpha,anchorsides:setData.sdiconsides,dip:setData.sdiconshape});currDerivedDataVal.showQD.data.push({showvalue:setData.showqdvalue,valueposition:setData.qdvalueposition,value:showQD&&(qdValue||UNDEF),anchorbgcolor:setData.qdiconcolor,anchorbordercolor:setData.qdiconbordercolor,anchorradius:setData.qdiconradius,anchoralpha:setData.qdiconalpha,anchorbgalpha:setData.qdiconalpha,anchorsides:setData.qdiconsides,dip:setData.qdiconshape});currDerivedDataVal.showMD.data.push({showvalue:setData.showmdvalue,valueposition:setData.mdvalueposition,value:showMD&&(mdValue||UNDEF),anchorbgcolor:setData.mdiconcolor,anchorbordercolor:setData.mdiconbordercolor,anchorradius:setData.mdiconradius,anchoralpha:setData.mdiconalpha,anchorbgalpha:setData.mdiconalpha,anchorsides:setData.mdiconsides,dip:setData.mdiconshape});if(outliers){outliersArr=currDerivedDataVal.outliers.data;outliers.split(_lib.COMMA).forEach(fn);currSubDS.outliers=true}}}subDSLen=requiredSubDs.length;for(k=0;k<subDSLen;k++){currSubDS=requiredSubDs[k];currDerivedDS=derivedDS[k]=[];for(i in currSubDS){currSubDS[i]&&currDerivedDS.push(derivedDataValue[k][i])}}return derivedDS};_proto.getDSdef=function getDSdef(){return _boxandwhisker.default};_proto.getDSGroupdef=function getDSGroupdef(){return _boxandwhiskerMultiseries.default};return BoxAndWhisker2D}(_mscolumn2d.default);var _default=BoxAndWhisker2D;exports.default=_default;