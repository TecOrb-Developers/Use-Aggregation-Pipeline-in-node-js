"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _index=_interopRequireDefault(require("../../../../fusioncharts/core/index.js"));var _index2=_interopRequireDefault(require("./index.js"));var _fusionchartsUsa=_interopRequireDefault(require("../../../../../_internal/vendors/xt-maps/source/maps/fusioncharts.usa.js"));var _fusionchartsWorld=_interopRequireDefault(require("../../../../../_internal/vendors/xt-maps/source/maps/fusioncharts.world.js"));var _utility=require("../../../../../smoke-test/test-sanity/utility");_index.default.addDep(_index2.default);_index.default.addDep(_fusionchartsUsa.default);_index.default.addDep(_fusionchartsWorld.default);var containerID="chart-container",domSetup=function domSetup(id){if(id===void 0){id=containerID}if(!document.getElementById(id)){var ele=document.createElement("div");ele.setAttribute("id",id);document.body.prepend(ele)}},domTeardown=function domTeardown(id){if(id===void 0){id=containerID}var ele=document.getElementById(id);if(ele)document.body.removeChild(ele)},data={type:"usa",renderAt:containerID,dataSource:{chart:{animation:false},colorrange:{gradient:true},data:[{id:"TX",value:68},{id:"HI",value:34}]}},updateData={type:"usa",renderAt:containerID,dataSource:{chart:{animation:false},colorrange:{gradient:false},data:[{id:"TX",value:68},{id:"HI",value:34}]}};describe("A Geo viz",(function(){beforeEach((function(){return domSetup(containerID)}));afterEach((function(){return domTeardown(containerID)}));it("should be able to render",(function(done){var chart=new _index.default(data).render();chart.addEventListener("rendercomplete",(function(_ref){var sender=_ref.sender;expect(sender).toBeDefined();sender.dispose()}));chart.addEventListener("disposed",(function(){return done()}))}));it("should be able to resize",(function(done){var chart=new _index.default(data).render();chart.addEventListener("resized",(function(_ref2){var sender=_ref2.sender;expect(sender).toBeDefined();sender.dispose()}));chart.addEventListener("rendercomplete",(function(_ref3){var sender=_ref3.sender;sender.resizeTo(600,600)}));chart.addEventListener("disposed",(function(){return done()}))}));it("should be able to update",(function(done){var chart=new _index.default(data).render();chart.addEventListener("rendercomplete",(function(_ref4){var sender=_ref4.sender;sender.setJSONData(updateData);sender.addEventListener("rendercomplete",(function(_ref5){var sender=_ref5.sender;sender.dispose()}))}));chart.addEventListener("disposed",(function(){return done()}))}))}));describe("Label cosmetics test of entity labels, marker labels and connector labels",(function(){var chartObj;afterEach((function(){return chartObj.dispose()}));it("Without valueFontColor, valueBgColor and valueBorderColor, chart should render normally",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Global Population Density",showLabels:"1",formatNumberScale:"0",animation:"0"},colorrange:{minvalue:"0",startlabel:"Low",endlabel:"High",code:"#FF4411",gradient:"1",color:[{maxvalue:"25",code:"#FFDD44",displayValue:"Median"},{maxvalue:"100",code:"#6baa01"}]},data:[{id:"NA",value:"22.1",showLabel:"1",displayValue:"Moderate"},{id:"SA",value:"22.0",showLabel:"1",displayValue:"Moderate"},{id:"AS",value:"95.0",showLabel:"1",displayValue:"Dense"},{id:"EU",value:"72.5",showLabel:"1",displayValue:"Dense"},{id:"AF",value:"33.7",showLabel:"1",displayValue:"Moderate"},{id:"AU",value:"3.2",showLabel:"1",displayValue:"Sparse"}]}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="entityLabels0"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i;expect(rects.length).toBe(0);expect(texts.length).toBe(6);for(i=0;i<texts.length;i++){expect(texts[i].getAttribute("fill")).toBe("#555555")}done()}));chartObj.render()}));it("entitylabelcolor, entitylabelbgcolor and entitylabelbordercolor should work from chart level",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Global Population Density",showLabels:"1",formatNumberScale:"0",entitylabelcolor:"ff0000",entitylabelbgcolor:"ffffff",entitylabelbordercolor:"000000",animation:"0"},colorrange:{minvalue:"0",startlabel:"Low",endlabel:"High",code:"#FF4411",gradient:"1",color:[{maxvalue:"25",code:"#FFDD44",displayValue:"Median"},{maxvalue:"100",code:"#6baa01"}]},data:[{id:"NA",value:"22.1",showLabel:"1",displayValue:"Moderate"},{id:"SA",value:"22.0",showLabel:"1",displayValue:"Moderate"},{id:"AS",value:"95.0",showLabel:"1",displayValue:"Dense"},{id:"EU",value:"72.5",showLabel:"1",displayValue:"Dense"},{id:"AF",value:"33.7",showLabel:"1",displayValue:"Moderate"},{id:"AU",value:"3.2",showLabel:"1",displayValue:"Sparse"}]}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="entityLabels0"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i;expect(rects.length).toBe(6);expect(texts.length).toBe(6);for(i=0;i<texts.length;i++){expect(texts[i].getAttribute("fill")).toBe("#ff0000");expect(rects[i].getAttribute("fill")).toBe("#ffffff");expect(rects[i].getAttribute("stroke")).toBe("#000000")}done()}));chartObj.render()}));it("entitylabelcolor, entitylabelbgcolor and entitylabelbordercolor should work from data level",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Global Population Density",showLabels:"1",formatNumberScale:"0",entitylabelcolor:"ff0000",entitylabelbgcolor:"ffffff",entitylabelbordercolor:"000000",animation:"0"},colorrange:{minvalue:"0",startlabel:"Low",endlabel:"High",code:"#FF4411",gradient:"1",color:[{maxvalue:"25",code:"#FFDD44",displayValue:"Median"},{maxvalue:"100",code:"#6baa01"}]},data:[{id:"NA",value:"22.1",showLabel:"1",displayValue:"Moderate",labelcolor:"00ff00",labelbgcolor:"0000ff",labelbordercolor:"ff0000"},{id:"SA",value:"22.0",showLabel:"1",displayValue:"Moderate"},{id:"AS",value:"95.0",showLabel:"1",displayValue:"Dense"},{id:"EU",value:"72.5",showLabel:"1",displayValue:"Dense"},{id:"AF",value:"33.7",showLabel:"1",displayValue:"Moderate"},{id:"AU",value:"3.2",showLabel:"1",displayValue:"Sparse"}]}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="entityLabels0"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i,count=0;expect(rects.length).toBe(6);expect(texts.length).toBe(6);for(i=0;i<texts.length;i++){if(texts[i].getAttribute("fill")==="#00ff00"&&rects[i].getAttribute("fill")==="#0000ff"&&rects[i].getAttribute("stroke")==="#ff0000"){count++}}expect(count).toBe(1);done()}));chartObj.render()}));it("markerlabelcolor, markerlabelbgcolor and markerlabelbordercolor should work from chart level",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Busiest Routes from Heathrow Airport",subcaption:"2014",markerBgColor:"#FF0000",markerRadius:"10",showMarkerLabels:"1",connectorColor:"#0CB2B0",connectorHoverColor:"#339933",entityFillColor:"#CECED2",entityFillHoverColor:"#E5E5E9",markerlabelcolor:"ff0000",markerlabelbgcolor:"ffffff",markerlabelbordercolor:"000000",animation:"0"},markers:{items:[{id:"lon",shapeid:"triangle",x:"340.23",y:"125.9",label:"LHR",tooltext:"Heathrow International Airport {br}IACL Code : EGLL",labelpos:"left"},{id:"nyc",shapeid:"triangle",x:"178.14",y:"154.9",label:"JFK",tooltext:"John F Kennedy Airport {br}IACL Code : KJFK",labelpos:"bottom"}]}}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="markerLabels"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i;expect(rects.length).toBe(2);expect(texts.length).toBe(2);for(i=0;i<texts.length;i++){expect(texts[i].getAttribute("fill")).toBe("#ff0000");expect(rects[i].getAttribute("fill")).toBe("#ffffff");expect(rects[i].getAttribute("stroke")).toBe("#000000")}done()}));chartObj.render()}));it("markerlabelcolor, markerlabelbgcolor and markerlabelbordercolor should work from data level",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Busiest Routes from Heathrow Airport",subcaption:"2014",markerBgColor:"#FF0000",markerRadius:"10",showMarkerLabels:"1",connectorColor:"#0CB2B0",connectorHoverColor:"#339933",entityFillColor:"#CECED2",entityFillHoverColor:"#E5E5E9",markerlabelcolor:"ff0000",markerlabelbgcolor:"ffffff",markerlabelbordercolor:"000000",animation:"0"},markers:{items:[{id:"lon",shapeid:"triangle",x:"340.23",y:"125.9",labelcolor:"00ff00",labelbgcolor:"0000ff",labelbordercolor:"ff0000",label:"LHR",tooltext:"Heathrow International Airport {br}IACL Code : EGLL",labelpos:"left"},{id:"nyc",shapeid:"triangle",x:"178.14",y:"154.9",label:"JFK",tooltext:"John F Kennedy Airport {br}IACL Code : KJFK",labelpos:"bottom"}]}}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="markerLabels"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i,count=0;expect(rects.length).toBe(2);expect(texts.length).toBe(2);for(i=0;i<texts.length;i++){if(texts[i].getAttribute("fill")==="#ff0000"&&rects[i].getAttribute("fill")==="#ffffff"&&rects[i].getAttribute("stroke")==="#000000"){count++}}expect(count).toBe(1);done()}));chartObj.render()}));it("connectorlabelcolor, connectorlabelbgcolor and connectorlabelbordercolor should work from chart level",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Busiest Routes from Heathrow Airport",subcaption:"2014",markerBgColor:"#FF0000",markerRadius:"10",showMarkerLabels:"1",connectorColor:"#0CB2B0",connectorHoverColor:"#339933",entityFillColor:"#CECED2",entityFillHoverColor:"#E5E5E9",connectorlabelcolor:"ff0000",connectorlabelbgcolor:"ffffff",connectorlabelbordercolor:"000000",animation:"0"},markers:{items:[{id:"lon",shapeid:"triangle",x:"340.23",y:"125.9",label:"LHR",tooltext:"Heathrow International Airport {br}IACL Code : EGLL",labelpos:"left"},{id:"nyc",shapeid:"triangle",x:"178.14",y:"154.9",label:"JFK",tooltext:"John F Kennedy Airport {br}IACL Code : KJFK",labelpos:"bottom"}],connectors:[{from:"lon",to:"nyc",label:"ABC"}]}}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="connectorLabels"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i;expect(rects.length).toBe(1);expect(texts.length).toBe(1);for(i=0;i<texts.length;i++){expect(texts[i].getAttribute("fill")).toBe("#ff0000");expect(rects[i].getAttribute("fill")).toBe("#ffffff");expect(rects[i].getAttribute("stroke")).toBe("#000000")}done()}));chartObj.render()}));it("connectorlabelcolor, connectorlabelbgcolor and connectorlabelbordercolor should work from data level",(function(done){chartObj=(0,_utility.setup)(_index.default,{type:"world",renderAt:_utility.CONTAINER_ID,width:600,height:350,dataSource:{chart:{caption:"Busiest Routes from Heathrow Airport",subcaption:"2014",markerBgColor:"#FF0000",markerRadius:"10",showMarkerLabels:"1",connectorColor:"#0CB2B0",connectorHoverColor:"#339933",entityFillColor:"#CECED2",entityFillHoverColor:"#E5E5E9",connectorlabelcolor:"ff0000",connectorlabelbgcolor:"ffffff",connectorlabelbordercolor:"000000",animation:"0"},markers:{items:[{id:"lon",shapeid:"triangle",x:"340.23",y:"125.9",labelcolor:"00ff00",labelbgcolor:"0000ff",labelbordercolor:"ff0000",label:"LHR",tooltext:"Heathrow International Airport {br}IACL Code : EGLL",labelpos:"left"},{id:"nyc",shapeid:"triangle",x:"178.14",y:"154.9",label:"JFK",tooltext:"John F Kennedy Airport {br}IACL Code : KJFK",labelpos:"bottom"}],connectors:[{from:"lon",to:"nyc",label:"ABC",labelcolor:"00ff00",labelbgcolor:"0000ff",labelbordercolor:"ff0000"}]}}});chartObj.addEventListener("renderComplete",(function(){var dataLabelGroup=document.querySelectorAll('[class$="connectorLabels"]')[0],rects=dataLabelGroup.getElementsByTagName("rect"),texts=dataLabelGroup.getElementsByTagName("text"),i,count=0;expect(rects.length).toBe(1);expect(texts.length).toBe(1);for(i=0;i<texts.length;i++){if(texts[i].getAttribute("fill")==="#00ff00"&&rects[i].getAttribute("fill")==="#0000ff"&&rects[i].getAttribute("stroke")==="#ff0000"){count++}}expect(count).toBe(1);done()}));chartObj.render()}))}));