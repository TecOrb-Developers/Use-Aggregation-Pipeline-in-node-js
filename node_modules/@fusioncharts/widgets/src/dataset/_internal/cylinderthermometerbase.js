"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _lib=require("@fusioncharts/core/src/lib");var _componentInterface=require("@fusioncharts/core/src/component-interface");var UNDEF,BLANKSTRING=_lib.BLANK,AXISPOSITION_TOP=1,AXISPOSITION_BOTTOM=3,gaugeFillColorStr=_lib.preDefStr.gaugeFillColorStr,gaugeBorderColorStr=_lib.preDefStr.gaugeBorderColorStr,dummyStr="dummy",FILLMIXDARK10="{dark-10}";var CylinderThermometerBase=function(_ComponentInterface){(0,_inheritsLoose2.default)(CylinderThermometerBase,_ComponentInterface);function CylinderThermometerBase(){return _ComponentInterface.apply(this,arguments)||this}var _proto=CylinderThermometerBase.prototype;_proto.getType=function getType(){return"dataset"};_proto.getName=function getName(){return"cylinderThermometerBase"};_proto.setValue=function setValue(setData,draw){if(!setData){return}var dataSet=this,datasetConfig=dataSet.config,chart=dataSet.getFromEnv("chart"),jsonChartObj=chart.getFromEnv("dataSource").chart,numberFormatter=dataSet.getFromEnv("number-formatter"),value=setData.value,tooltext=setData.tooltext||jsonChartObj.plottooltext,formattedValue;datasetConfig.value=value=numberFormatter.getCleanValue(value);if(value!==null){formattedValue=datasetConfig.formattedValue=numberFormatter.dataLabels(datasetConfig.value);if(!datasetConfig.showValue){datasetConfig.displayValue=BLANKSTRING}else{datasetConfig.displayValue=setData.label||(0,_lib.getValidValue)(formattedValue,_lib.BLANK)}if(!datasetConfig.showTooltip){datasetConfig.toolText=BLANKSTRING}else if(tooltext!==UNDEF){datasetConfig.toolText=(0,_lib.parseUnsafeString)((0,_lib.parseTooltext)((0,_lib.pluck)(setData.tooltext,tooltext),[1,2],{formattedValue:formattedValue,value:value},setData,jsonChartObj),false)}else{datasetConfig.toolText=(0,_lib.parseUnsafeString)((0,_lib.parseTooltext)((0,_lib.pluck)(setData.tooltext,formattedValue===null?BLANKSTRING:formattedValue)),false)}}else{datasetConfig.displayValue=BLANKSTRING;datasetConfig.toolText=BLANKSTRING;datasetConfig.formattedValue=null}if(draw){dataSet.draw()}};_proto.configure=function configure(dataSetJson){if(!dataSetJson){return false}this.setValue(dataSetJson&&dataSetJson.data&&dataSetJson.data[0]);var dataSet=this,chart=dataSet.getFromEnv("chart"),jsonData=chart.getFromEnv("dataSource"),chartAttrs=jsonData.chart,datasetConfig=dataSet.config||(dataSet.config={}),colorM=dataSet.getFromEnv("color-manager"),chartConfig=chart.config,gaugeBorderAlpha,showHoverEffect=(0,_lib.pluckNumber)(chartAttrs.showhovereffect),plotFillHoverColor,gaugeFillAlpha,gaugeFillColor;datasetConfig.showValue=(0,_lib.pluckNumber)(chartAttrs.showvalue,chartAttrs.showvalues,1);datasetConfig.showTooltip=(0,_lib.pluckNumber)(chartAttrs.showtooltip,1);datasetConfig.valuePadding=(0,_lib.pluckNumber)(chartAttrs.valuepadding,2);datasetConfig.tooltipSepChar=(0,_lib.pluck)(chartAttrs.tooltipsepchar,_lib.COMMASTRING);datasetConfig.pointerOnOpp=(0,_lib.pluckNumber)(chartAttrs.pointerontop,0);datasetConfig.axisPosition=(0,_lib.pluckNumber)(chartAttrs.ticksbelowgauge,chartAttrs.ticksbelowgraph,this.ticksbelowgauge,1)?AXISPOSITION_BOTTOM:AXISPOSITION_TOP;datasetConfig.valueAbovePointer=(0,_lib.pluckNumber)(chartAttrs.valueabovepointer,1);datasetConfig.labelStyle=chartConfig.dataLabelStyle;gaugeFillColor=datasetConfig.gaugeFillColor=(0,_lib.pluck)(chartAttrs.gaugefillcolor,chartAttrs.thmfillcolor,chartAttrs.cylfillcolor,colorM.getColor(gaugeFillColorStr));gaugeFillAlpha=datasetConfig.gaugeFillAlpha=(0,_lib.pluckNumber)(chartAttrs.gaugefillalpha,chartAttrs.cylfillalpha,chartAttrs.thmfillalpha,_lib.HUNDREDSTRING);datasetConfig.showGaugeBorder=(0,_lib.pluckNumber)(chartAttrs.showgaugeborder,1);gaugeBorderAlpha=datasetConfig.showGaugeBorder?(0,_lib.pluckNumber)(chartAttrs.gaugeborderalpha,40):0;datasetConfig.rawGaugeBorderColor=(0,_lib.pluck)(chartAttrs.gaugebordercolor,colorM.getColor(gaugeBorderColorStr));datasetConfig.gaugeBorderAlpha=gaugeBorderAlpha;datasetConfig.gaugeBorderColor=(0,_lib.convertColor)(datasetConfig.rawGaugeBorderColor,gaugeBorderAlpha);datasetConfig.gaugeBorderThickness=(0,_lib.pluckNumber)(chartAttrs.gaugeborderthickness,1);datasetConfig.gaugeContainerColor=(0,_lib.pluck)(chartAttrs.thmglasscolor,chartAttrs.cylglasscolor,chart.glasscolor,(0,_lib.getLightColor)(gaugeFillColor,30));if(showHoverEffect!==0&&(showHoverEffect||chartAttrs.plotfillhovercolor||chartAttrs.plotfillhoveralpha||chartAttrs.plotfillhoveralpha===0)){datasetConfig.showHoverEffect=true;plotFillHoverColor=(0,_lib.pluck)(chartAttrs.plotfillhovercolor,chartAttrs.cylfillhovercolor,chartAttrs.thmfillhovercolor,FILLMIXDARK10);datasetConfig.plotFillHoverAlpha=(0,_lib.pluckNumber)(chartAttrs.plotfillhoveralpha,chartAttrs.cylfillhoveralpha,chartAttrs.thmfillhoveralpha,gaugeFillAlpha);datasetConfig.plotFillHoverColor=/\{/.test(plotFillHoverColor)?colorM.parseColorMix(gaugeFillColor,plotFillHoverColor)[0]:plotFillHoverColor}dataSet.setValue(jsonData);chart._parseSpecialConfig&&chart._parseSpecialConfig()};_proto._getLabelSpace=function _getLabelSpace(){var dataSet=this,datasetConfig=dataSet.config,chart=dataSet.getFromEnv("chart"),smartLabel=dataSet.getFromEnv("smartLabel"),labelObj;smartLabel.useEllipsesOnOverflow(chart.config.useEllipsesWhenOverflow);smartLabel.setStyle(datasetConfig.labelStyle);labelObj=smartLabel.getOriSize(datasetConfig.displayValue!==_lib.BLANK?datasetConfig.displayValue:dummyStr);return labelObj.height?labelObj.height+datasetConfig.valuePadding:0};_proto.getDataLimits=function getDataLimits(){var dataSet=this,datasetConfig=dataSet.config,min,max;max=min=datasetConfig.value;datasetConfig.maxValue=max;datasetConfig.minValue=min;return{forceMin:true,forceMax:true,max:max,min:min}};_proto.updateData=function updateData(){var dataSet=this,dataObj=arguments[0],draw=arguments[2],conf=dataSet.config,prevMax=conf.maxValue,prevMin=conf.prevMin,value=conf.value,chart=dataSet.getFromEnv("chart"),drawManager=dataSet.groupManager||dataSet,scale=dataSet.getFromEnv("scale");dataSet.setValue(dataObj.data[0]);conf.maxValue=value;conf.minValue=value;if(conf.maxValue!==prevMax||conf.minValue!==prevMin){dataSet.config.maxminFlag=true}if(draw){chart._setAxisLimits();scale.draw();drawManager.draw()}};_proto.setJSONIndex=function setJSONIndex(index){this.config.index=index};_proto.getJSONIndex=function getJSONIndex(){return this.config.index||0};return CylinderThermometerBase}(_componentInterface.ComponentInterface);var _default=CylinderThermometerBase;exports.default=_default;