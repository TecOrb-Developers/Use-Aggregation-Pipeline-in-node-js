"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _gaugewidget=_interopRequireDefault(require("../_internal/gaugewidget"));var _bulb=_interopRequireDefault(require("../../dataset/bulb"));var _lib=require("@fusioncharts/core/src/lib");var _colorBucket=_interopRequireDefault(require("@fusioncharts/core/src/color-utils/color-bucket"));var _vledDataset=_interopRequireDefault(require("../../factories/vled-dataset"));var UNDEF,BULB="bulb",FRIENDLY_NAME="Bulb Gauge";var Bulb=function(_GaugeWidget){(0,_inheritsLoose2.default)(Bulb,_GaugeWidget);Bulb.getName=function getName(){return"Bulb"};function Bulb(){var _this;_this=_GaugeWidget.call(this)||this;_this.isRealTime=true;_this._drawCanvas=function(){};_this.registerFactory("dataset",_vledDataset.default,["vCanvas"]);return _this}var _proto=Bulb.prototype;_proto.getName=function getName(){return"Bulb"};_proto._clearChart=function _clearChart(){};_proto.configureAttributes=function configureAttributes(dataObj){_GaugeWidget.prototype.configureAttributes.call(this,dataObj);var iapi=this,jsonData=iapi.getFromEnv("dataSource"),colorrange=jsonData.colorrange;(0,_lib.componentFactory)(iapi,_colorBucket.default,"colorRange",1,[{colorRange:colorrange,numberFormatter:iapi.getFromEnv("number-formatter")}]);iapi.addToEnv("colorRange",iapi.getChildren("colorRange")[0])};_proto.__setDefaultConfig=function __setDefaultConfig(){_GaugeWidget.prototype.__setDefaultConfig.call(this);var config=this.config;config.showRTvalue=false;config.canvasPadding=false;config.defaultSeriesType=BULB;config.defaultPlotShadow=1;config.drawAnnotations=true;config.charttopmargin=10;config.chartrightmargin=10;config.chartbottommargin=10;config.chartleftmargin=10;config.realtimeEnabled=true;config.isRealTime=true;config.friendlyName=FRIENDLY_NAME;config.defaultDatasetType=BULB;config.placevaluesinside=0;config.hasgaugeoriginx=UNDEF;config.gaugeoriginx=UNDEF;config.hasgaugeoriginy=UNDEF;config.gaugeoriginy=UNDEF;config.hasgaugeradius=UNDEF;config.gaugeradius=UNDEF;config.valuepadding=2;config.showgaugeborder=0;config.showhovereffect=UNDEF;config.autoscale=1;config.skipCanvasDrawing=true};_proto._spaceManager=function _spaceManager(){var availableHeight,iapi=this,config=iapi.config,dataset=iapi.getChildren("dataset")[0],datasetConfig=dataset.config,is3D=iapi.config.is3D,chartAttrs=iapi.getFromEnv("dataSource").chart,showBorder=(0,_lib.pluckNumber)(chartAttrs.showborder,is3D?0:1),chartBorderHorizontal,chartBorderVertical,minChartWidth=config.minChartWidth,minChartHeight=config.minChartHeight,chartBorderWidth=config.borderWidth=showBorder?(0,_lib.pluckNumber)(chartAttrs.borderthickness,1):0;if(config.autoscale){datasetConfig.scaleFactor=Bulb._getScaleFactor(datasetConfig.origW,datasetConfig.origH,config.width,config.height)}else{datasetConfig.scaleFactor=1}if(config.canvasWidth-2*chartBorderWidth<minChartWidth){chartBorderVertical=(config.canvasWidth-minChartWidth)/2}if(config.canvasHeight-2*chartBorderWidth<minChartHeight){chartBorderHorizontal=(config.canvasHeight-minChartHeight)/2}iapi._allocateSpace({top:chartBorderHorizontal||chartBorderWidth,bottom:chartBorderHorizontal||chartBorderWidth,left:chartBorderVertical||chartBorderWidth,right:chartBorderVertical||chartBorderWidth});iapi._allocateSpace(iapi._manageActionBarSpace&&iapi._manageActionBarSpace(config.availableHeight*.225)||{});availableHeight=config.canvasHeight*.7;iapi._manageChartMenuBar(availableHeight);dataset._manageSpace&&iapi._allocateSpace(dataset._manageSpace(availableHeight))};_proto.allocatePosition=function allocatePosition(){var iapi=this,chartConfig=iapi.config,dataset=iapi.getDatasets()[0],conf=dataset.config,radius,canvasHeight=chartConfig.canvasHeight,canvasWidth=chartConfig.canvasWidth,canvasTop=chartConfig.canvasTop,canvasLeft=chartConfig.canvasLeft,gaugeOriginX=chartConfig.gaugeoriginx,gaugeOriginY=chartConfig.gaugeoriginy,gaugeRadius=chartConfig.gaugeradius,hasGaugeOriginX=chartConfig.hasgaugeoriginx,hasGaugeOriginY=chartConfig.hasgaugeoriginy,hasGaugeRadius=chartConfig.hasgaugeradius;gaugeOriginX=hasGaugeOriginX!==UNDEF?gaugeOriginX*conf.scaleFactor:canvasLeft+canvasWidth/2;gaugeOriginY=hasGaugeOriginY!==UNDEF?gaugeOriginY*conf.scaleFactor:canvasTop+canvasHeight/2;radius=hasGaugeRadius!==UNDEF?gaugeRadius*conf.scaleFactor:Math.min(canvasWidth/2,canvasHeight/2);chartConfig.gaugeStartX=gaugeOriginX-radius;chartConfig.gaugeEndX=gaugeOriginX+radius;chartConfig.gaugeStartY=gaugeOriginY-radius;chartConfig.gaugeEndY=gaugeOriginY+radius;chartConfig.gaugeCenterX=gaugeOriginX;chartConfig.gaugeCenterY=gaugeOriginY;chartConfig.gaugeRadius=radius};_proto._getData=function _getData(){var iapi=this,dataset=iapi.getChildren("dataset"),data,dataObj;if(dataset){dataObj=dataset[0].components.data;if(dataObj&&dataObj[0]){data=dataObj[0].config;return(0,_lib.pluckNumber)(data.setValue,data.itemValue)}}};_proto._postSpaceManagement=function _postSpaceManagement(){this.allocateDimensionOfChartMenuBar()};_proto.getDSdef=function getDSdef(){return _bulb.default};Bulb._getScaleFactor=function _getScaleFactor(_origW,_origH,canvasWidth,canvasHeight){var scaleFactor,origH=_origH,origW=_origW;origH=(0,_lib.pluckNumber)(origH,canvasHeight);origW=(0,_lib.pluckNumber)(origW,canvasWidth);if(!origH||!origW){scaleFactor=1}else if(origW/canvasWidth===origH/canvasHeight){scaleFactor=canvasWidth/origW}else{scaleFactor=Math.min(canvasWidth/origW,canvasHeight/origH)}return scaleFactor};return Bulb}(_gaugewidget.default);var _default=Bulb;exports.default=_default;