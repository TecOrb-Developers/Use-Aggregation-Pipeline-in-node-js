"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _gaugewidget=_interopRequireDefault(require("./gaugewidget"));var _messagelogger=_interopRequireDefault(require("@fusioncharts/features/src/messagelogger"));var _alertmanager=_interopRequireDefault(require("@fusioncharts/features/src/alertmanager"));var _constructor=_interopRequireDefault(require("@fusioncharts/constructor/src/constructor"));var _lib=require("@fusioncharts/core/src/lib");var _equal=_interopRequireDefault(require("@fusioncharts/utils/src/string/equal"));var UNDEF;var Gauge=function(_GaugeWidget){(0,_inheritsLoose2.default)(Gauge,_GaugeWidget);function Gauge(){var _this;_this=_GaugeWidget.call(this)||this;_constructor.default.addDep(_messagelogger.default);_constructor.default.addDep(_alertmanager.default);var WATERMARK_SPACE=37;_this.chartLeftMargin=15;_this.chartRightMargin=15;_this.chartTopMargin=10;_this.chartBottomMargin=WATERMARK_SPACE;_this.minChartHeight=10;_this.minCanvasWidth=0;return _this}var _proto=Gauge.prototype;_proto._feedAxesRawData=function _feedAxesRawData(){var iapi=this,config=iapi.config,colorM=iapi.getFromEnv("color-manager"),dataObj=iapi.getFromEnv("dataSource"),chartAttrs=dataObj.chart,scaleConf,palleteString=_lib.chartPaletteStr.chart2D,ticksBelowGauge=(0,_lib.pluckNumber)(chartAttrs.ticksbelowgauge),ticksonright=(0,_lib.pluckNumber)(chartAttrs.ticksonright),isAxisOpposite=(0,_lib.pluckNumber)((0,_equal.default)(chartAttrs.scaleposition,config.scalePosition)?config.isAxisOpposite:(0,_equal.default)(chartAttrs.scaleposition,config.canBeScalePosition)?!config.isAxisOpposite:UNDEF,ticksBelowGauge!==UNDEF?!ticksBelowGauge:UNDEF,ticksonright!==UNDEF?ticksonright:UNDEF,config.isAxisOpposite),isAxisReverse=(0,_lib.pluckNumber)(chartAttrs.reverseaxis,iapi.isAxisReverse),isScaleReverse=(0,_lib.pluckNumber)(chartAttrs.reversescale,0),showTickMarks=(0,_lib.pluckNumber)(chartAttrs.showtickmarks,1),numberFormatter=iapi.getFromEnv("number-formatter"),showTickValues=(0,_lib.pluckNumber)(chartAttrs.showtickvalues),outCanfontSizeWithUnit=(0,_lib.pluckFontSizeMaintainUnit)(chartAttrs.outcnvbasefontsize,chartAttrs.basefontsize,10),showLimits;if(!showTickValues&&showTickValues!==UNDEF){showLimits=false}else if(!showTickMarks&&showTickValues===UNDEF){showLimits=false}else{showLimits=true}scaleConf={isVertical:!iapi.isHorizontal,isReverse:iapi.isHorizontal?isScaleReverse:!isAxisReverse,isOpposit:isAxisOpposite,outCanfontFamily:(0,_lib.pluck)(chartAttrs.outcnvbasefont,chartAttrs.basefont,"Verdana,sans"),outCanfontSize:this.computeFontSize(outCanfontSizeWithUnit),outCanfontSizeWithUnit:outCanfontSizeWithUnit,outCancolor:(0,_lib.pluck)(chartAttrs.outcnvbasefontcolor,chartAttrs.basefontcolor,colorM.getColor(palleteString.baseFontColor)).replace(/^#?([a-f0-9]+)/gi,"#$1"),useEllipsesWhenOverflow:chartAttrs.useellipseswhenoverflow,divLineColor:(0,_lib.pluck)(chartAttrs.vdivlinecolor,colorM.getColor(palleteString.divLineColor)),divLineAlpha:(0,_lib.pluck)(chartAttrs.vdivlinealpha,colorM.getColor("divLineAlpha")),divLineThickness:(0,_lib.pluckNumber)(chartAttrs.vdivlinethickness,1),divLineIsDashed:Boolean((0,_lib.pluckNumber)(chartAttrs.vdivlinedashed,chartAttrs.vdivlineisdashed,0)),divLineDashLen:(0,_lib.pluckNumber)(chartAttrs.vdivlinedashlen,4),divLineDashGap:(0,_lib.pluckNumber)(chartAttrs.vdivlinedashgap,2),showAlternateGridColor:(0,_lib.pluckNumber)(chartAttrs.showalternatevgridcolor,0),alternateGridColor:(0,_lib.pluck)(chartAttrs.alternatevgridcolor,colorM.getColor("altVGridColor")),alternateGridAlpha:(0,_lib.pluck)(chartAttrs.alternatevgridalpha,colorM.getColor("altVGridAlpha")),numDivLines:chartAttrs.numvdivlines,labelFont:chartAttrs.labelfont,labelFontSize:this.computeFontSize(chartAttrs.labelfontsize),labelFontSizeWithUnit:chartAttrs.labelfontsize,labelFontColor:chartAttrs.labelfontcolor,labelAlpha:chartAttrs.labelalpha,labelFontBold:chartAttrs.labelfontbold,labelFontItalic:chartAttrs.labelfontitalic,axisName:chartAttrs.xaxisname,axisMinValue:numberFormatter.getCleanValue(chartAttrs.lowerlimit),axisMaxValue:numberFormatter.getCleanValue(chartAttrs.upperlimit),setAdaptiveMin:chartAttrs.setadaptivemin,adjustDiv:chartAttrs.adjusttm,labelDisplay:chartAttrs.labeldisplay,showLabels:chartAttrs.showlabels,rotateLabels:chartAttrs.rotatelabels,slantLabel:(0,_lib.pluckNumber)(chartAttrs.slantlabels,chartAttrs.slantlabel),labelStep:(0,_lib.pluckNumber)(chartAttrs.labelstep,chartAttrs.xaxisvaluesstep),showAxisValues:(0,_lib.pluckNumber)(chartAttrs.showxaxisvalues,chartAttrs.showxaxisvalue),showDivLineValues:(0,_lib.pluckNumber)(chartAttrs.showvdivlinevalues,chartAttrs.showvdivlinevalues),showZeroPlane:chartAttrs.showvzeroplane,zeroPlaneColor:chartAttrs.vzeroplanecolor,zeroPlaneThickness:chartAttrs.vzeroplanethickness,zeroPlaneAlpha:chartAttrs.vzeroplanealpha,showZeroPlaneValue:chartAttrs.showvzeroplanevalue,trendlineColor:chartAttrs.trendlinecolor,trendlineToolText:chartAttrs.trendlinetooltext,trendlineThickness:chartAttrs.trendlinethickness,trendlineAlpha:chartAttrs.trendlinealpha,showTrendlinesOnTop:chartAttrs.showtrendlinesontop,showAxisLine:(0,_lib.pluckNumber)(chartAttrs.showxaxisline,chartAttrs.showaxislines,chartAttrs.drawAxisLines,0),axisLineThickness:(0,_lib.pluckNumber)(chartAttrs.xaxislinethickness,chartAttrs.axislinethickness,1),axisLineAlpha:(0,_lib.pluckNumber)(chartAttrs.xaxislinealpha,chartAttrs.axislinealpha,100),axisLineColor:(0,_lib.pluck)(chartAttrs.xaxislinecolor,chartAttrs.axislinecolor,"#000000"),majorTMNumber:chartAttrs.majortmnumber,majorTMColor:chartAttrs.majortmcolor,majorTMAlpha:chartAttrs.majortmalpha,majorTMHeight:chartAttrs.majortmheight,tickValueStep:chartAttrs.tickvaluestep,showTickMarks:chartAttrs.showtickmarks,connectTickMarks:chartAttrs.connecttickmarks,showTickValues:chartAttrs.showtickvalues,majorTMThickness:chartAttrs.majortmthickness,reverseScale:chartAttrs.reversescale,showLimits:chartAttrs.showlimits||showLimits,minorTMNumber:(0,_lib.pluckNumber)(chartAttrs.minortmnumber,iapi.minorTMNumber,4),minorTMColor:chartAttrs.minortmcolor,minorTMAlpha:chartAttrs.minortmalpha,minorTMHeight:(0,_lib.pluckNumber)(chartAttrs.minortmheight,chartAttrs.minortmwidth),minorTMThickness:chartAttrs.minortmthickness,tickMarkDistance:(0,_lib.pluckNumber)(chartAttrs.tickmarkdistance,chartAttrs.tickmarkgap),tickValueDistance:(0,_lib.pluckNumber)(chartAttrs.tickvaluedistance,chartAttrs.displayvaluedistance),placeTicksInside:chartAttrs.placeticksinside,placeValuesInside:chartAttrs.placevaluesinside,upperLimitDisplay:chartAttrs.upperlimitdisplay,lowerLimitDisplay:chartAttrs.lowerlimitdisplay,drawTickMarkConnector:iapi.isHorizontal?1:0};scaleConf.vtrendlines=dataObj.trendpoints;return[scaleConf]};_proto._setAxisLimits=function _setAxisLimits(){var iapi=this,chartAttrs=iapi.getFromEnv("dataSource").chart,scale=iapi.getChildren("scale")[0],minMaxObj;minMaxObj=iapi.getChildren("dataset")[0].getDataLimits();minMaxObj.max===-Infinity&&(minMaxObj.max=0);minMaxObj.min===Infinity&&(minMaxObj.min=0);iapi.colorRange&&scale.setAxisConfig({axisMinValue:(0,_lib.pluckNumber)(chartAttrs.lowerlimit,minMaxObj.forceMin?minMaxObj.min:UNDEF),axisMaxValue:(0,_lib.pluckNumber)(chartAttrs.upperlimit,minMaxObj.forceMax?minMaxObj.max:UNDEF)});scale.setDataLimit(minMaxObj.max,minMaxObj.min)};_proto._getDataJSON=function _getDataJSON(){var i=0,len,dataObj,values=[],labels=[],toolTexts=[],data=this.getChildren("dataset")[0].components.data;if(!data||!data.length){len=0}else{len=data.length}for(;i<len;i+=1){dataObj=data[i].config;values.push(dataObj.itemValue);labels.push(dataObj.formatedVal||_lib.BLANK);toolTexts.push(dataObj.toolText||_lib.BLANK)}return{values:values,labels:labels,toolTexts:toolTexts}};_proto._postSpaceManagement=function _postSpaceManagement(){var iapi=this,config=iapi.config,canvas=iapi.getChildren("canvas")[0],scale=iapi.getChildren("scale")[0],isHorizontal=iapi.isHorizontal,canvasConf=canvas.config;if(isHorizontal){scale.setAxisDimention({axisLength:config.canvasWidth,y:canvasConf.canvasTop+(scale.config.isOpposit?0:canvasConf.canvasHeight),x:canvasConf.canvasLeft})}else{scale.setAxisDimention({axisLength:config.canvasHeight,x:canvasConf.canvasLeft+(scale.config.isOpposit?canvasConf.canvasWidth:0),y:canvasConf.canvasTop})}iapi.allocateDimensionOfChartMenuBar()};_proto._clearChart=function _clearChart(){};return Gauge}(_gaugewidget.default);var _default=Gauge;exports.default=_default;