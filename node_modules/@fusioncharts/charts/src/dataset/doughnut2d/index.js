"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=exports._getInnerSize=void 0;var _inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose"));var _pie2d=_interopRequireDefault(require("../pie2d"));var _dependencyManager=require("@fusioncharts/core/src/dependency-manager");var _lib=require("@fusioncharts/core/src/lib");var _index=_interopRequireDefault(require("./index.animation"));var COMMASTRING=",",FIFTY_PERCENT="50%",_getInnerSize2=function _getInnerSize(){var innerradius,dataSet=this,chart=dataSet.getFromEnv("chart"),dataSetConfig=dataSet.config,chartAttr=chart.getFromEnv("dataSource").chart,doughnutRadius=dataSetConfig.doughnutradius,use3DLighting=(0,_lib.pluckNumber)(chartAttr.use3dlighting,1),radius3D=use3DLighting?(0,_lib.pluckNumber)(chartAttr.radius3d,chartAttr["3dradius"],50):100,innerpercentR,diff50Percent,radius3Dpercent,pointConfig,poin2nd,ratioStr,x,point,data,length,pieMinRadius=dataSetConfig.pieMinRadius;if(radius3D>100){radius3D=100}if(radius3D<0){radius3D=0}if(/%/.test(doughnutRadius)){doughnutRadius=Number(doughnutRadius.split("%")[0])/100;innerradius=pieMinRadius*doughnutRadius}else if(doughnutRadius<=0||doughnutRadius>=pieMinRadius){innerradius=pieMinRadius/2}else{innerradius=(0,_lib.pluckNumber)(doughnutRadius)}dataSetConfig.innerRadius=innerradius;if(radius3D>0&&_lib.hasSVG){innerpercentR=parseInt(innerradius/pieMinRadius*100,10);diff50Percent=(100-innerpercentR)/2;radius3Dpercent=parseInt(diff50Percent*radius3D/100,10);poin2nd=2*(diff50Percent-radius3Dpercent);ratioStr=innerpercentR+COMMASTRING+radius3Dpercent+COMMASTRING+poin2nd+COMMASTRING+radius3Dpercent;if(dataSet&&(data=dataSet.components.data)){for(x=0,length=data.length;x<length;x+=1){point=data[x];pointConfig=point.config;if(pointConfig.color){pointConfig.color.ratio=ratioStr;if(pointConfig.hoverEffects&&pointConfig.hoverEffects.color){pointConfig.hoverEffects.color.ratio=ratioStr}}}}}return innerradius*2};exports._getInnerSize=_getInnerSize2;(0,_dependencyManager.addDep)({name:"doughnut2dAnimation",type:"animationRule",extension:_index.default});var Doughnut2DDataset=function(_Pie2DDataset){(0,_inheritsLoose2.default)(Doughnut2DDataset,_Pie2DDataset);function Doughnut2DDataset(){return _Pie2DDataset.apply(this,arguments)||this}var _proto=Doughnut2DDataset.prototype;_proto.getType=function getType(){return"dataset"};_proto.getName=function getName(){return"doughnut2D"};_proto.configureAttributes=function configureAttributes(dataObj){_Pie2DDataset.prototype.configureAttributes.call(this,dataObj);var dataset=this,conf=dataset.config,chartConfig=dataset.getFromEnv("chartConfig");conf.doughnutradius=(0,_lib.pluck)(chartConfig.doughnutradius,conf.doughnutradius,"50%")};_proto.__setDefaultConfig=function __setDefaultConfig(){_Pie2DDataset.prototype.__setDefaultConfig.call(this);this.config.doughnutradius=FIFTY_PERCENT};_proto._parsePiePlotOptions=function _parsePiePlotOptions(){var dataSet=this,piePlotOptions=_Pie2DDataset.prototype._parsePiePlotOptions.call(this);piePlotOptions.innerSize=dataSet._getInnerSize();return piePlotOptions};_proto._getInnerSize=function _getInnerSize(){return _getInnerSize2.call(this)};_proto.allocatePosition=function allocatePosition(){this.config.innerSize=this._getInnerSize();_Pie2DDataset.prototype.allocatePosition.call(this)};return Doughnut2DDataset}(_pie2d.default);var _default=Doughnut2DDataset;exports.default=_default;